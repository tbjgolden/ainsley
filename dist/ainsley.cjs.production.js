/*! ainsley | MIT License | @tbjgolden | tom.bio */
"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}function _interopNamespace(e){if(e&&e.__esModule)return e;var r={};return e&&Object.keys(e).forEach((function(a){var t=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(r,a,t.get?t:{enumerable:!0,get:function(){return e[a]}})})),r.default=e,r}Object.defineProperty(exports,"__esModule",{value:!0});var fetch=_interopDefault(require("isomorphic-unfetch")),copy$1=_interopDefault(require("fast-copy"));const isObject=e=>!(null===e||"object"!=typeof e||Array.isArray(e)),combinations=e=>{let r=[[]],a=0;for(;a<e.length;)r=e[a++].flatMap(e=>r.map(r=>r.concat([e])));return r},ITERATOR_REGEX="\\{[a-zA-Z0-9_-]+\\}",DEFAULT_OPTIONS={addVariationToSelector:(e,r)=>r+"-"+e,addPropertyToSelector:(e,r)=>e+r.toLowerCase(),addValueToSelector:(e,r)=>e+r.toUpperCase(),abbreviateProperty:e=>[e.split("-").map(e=>e.charAt(0)).join("").toLowerCase(),e.toLowerCase()]},ITERATOR_SEARCH=/\{[a-zA-Z0-9_-]+\}/g,generate=(e,r={})=>{const a={...DEFAULT_OPTIONS,...r};return generateFromAst(ainsleyToAst(e,a,{}),a)},generateFromAst=(e,r)=>{let a="",t=[];for(let i=0;i<e.length;i++){const n=e[i];let o=0;for(;o<t.length&&t[o]===n.t[o];)o+=1;const s=t.slice(o);for(const e of s){e[1].startsWith("@")&&(a+="}")}const f=n.t.slice(o);for(const e of f){const r=e[1];r.startsWith("@")&&(a+=r+"{")}if("string"==typeof n.i)a+=n.i;else{let e=n.i[0],t="";for(let a=0;a<n.t.length;a++){const i=n.t[a][0],o=n.t[a][1];""!==o&&(o.startsWith("@")||(t+=""+o),e=r.addVariationToSelector(e,i))}a+=`.${e}${t}{${n.i[1].map(e=>`${e[0]}:${e[1]}`).join(";")}}`}t=n.t}for(const e of t){e[1].startsWith("@")&&(a+="}")}return a},ainsleyToAst=(e,r,a)=>{var t;const i={...a};if(void 0!==e.variables){const r=e.variables;Object.keys(r).map(e=>{const t=parseVariable(e),n=t[0],o=t[1];0===n?i[o]=r[e]:2===n&&(i[o]={...a[o],...r[e]})})}const n=void 0===e.children?[]:ainsleyChildrenToAst(e.children,r,i);return combinations((null!==(t=e.variations)&&void 0!==t?t:[]).map(e=>[["",""]].concat(e))).flatMap(e=>n.map(r=>{if("string"==typeof r.i||Array.isArray(r.i)){const a=r;return{t:[...e,...a.t],i:a.i}}{const a=r;return{t:[...e,...a.t],i:a.i.i}}}))},ainsleyChildrenToAst=(e,r,a)=>e.flatMap(e=>"string"==typeof e?[{t:[],i:e}]:Array.isArray(e)?Array.isArray(e[1])?ainsleyRuleToAst(e,r,a):ainsleyPropertyToAst(e,r):ainsleyToAst(e,r,a)),ainsleyRuleToAst=(e,r,a)=>{const t=e[0],i=e[1],n=[];return i.map(e=>{var r,a;const t=null!==(r=e[0].match(ITERATOR_SEARCH))&&void 0!==r?r:[],i=null!==(a=(""+e[1]).match(ITERATOR_SEARCH))&&void 0!==a?a:[];t.map(e=>n.push([e,0])),i.map(e=>n.push([e,1]))}),combinations(n.map(e=>{const r=e[0],t=e[1],i=r.slice(1,-1);return Object.keys(a[i]).map(e=>[r,e,a[i][e],t])})).map(e=>{let a=0,n=e[a];return{t:[],i:[e.reduce((e,a)=>0===a[3]?r.addPropertyToSelector(e,a[1]):r.addValueToSelector(e,a[1]),t),i.map(r=>{const t=r=>{for(;a<e.length&&r.includes(n[0]);)r=r.replace(n[0],""+n[2]),n=e[++a];return r};return[t(r[0]),t(""+r[1])]})]}})},ainsleyPropertyToAst=(e,r)=>{const a=e[1],t=r.abbreviateProperty(e[0]),i=t[0],n=t[1];return Object.keys(a).map(e=>({t:[],i:[r.addValueToSelector(r.addPropertyToSelector("",i),e),[[n,a[e]]]]}))},parseVariable=e=>{const r="?+".indexOf(e[0])+1;return[r,r>0?e.slice(1):e]},embed=(e,r)=>{let a=null;void 0!==r&&(a=document.querySelector("style#"+r)),null===a&&(a=document.createElement("style"),a.type="text/css",void 0!==r&&a.setAttribute("id",r),document.head.appendChild(a)),a.innerHTML=e};var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function unwrapExports(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function createCommonjsModule(e,r){return e(r={exports:{}},r.exports),r.exports}function getCjsExportFromNamespace(e){return e&&e.default||e}var uri_all=createCommonjsModule((function(e,r){!function(e){function r(){for(var e=arguments.length,r=Array(e),a=0;a<e;a++)r[a]=arguments[a];if(r.length>1){r[0]=r[0].slice(0,-1);for(var t=r.length-1,i=1;i<t;++i)r[i]=r[i].slice(1,-1);return r[t]=r[t].slice(1),r.join("")}return r[0]}function a(e){return"(?:"+e+")"}function t(e){return void 0===e?"undefined":null===e?"null":Object.prototype.toString.call(e).split(" ").pop().split("]").shift().toLowerCase()}function i(e){return e.toUpperCase()}function n(e){var t=r("[0-9]","[A-Fa-f]"),i=a(a("%[EFef]"+t+"%"+t+t+"%"+t+t)+"|"+a("%[89A-Fa-f]"+t+"%"+t+t)+"|"+a("%"+t+t)),n="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",o=r("[\\:\\/\\?\\#\\[\\]\\@]",n),s=e?"[\\uE000-\\uF8FF]":"[]",f=r("[A-Za-z]","[0-9]","[\\-\\.\\_\\~]",e?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]"),l=(a("[A-Za-z]"+r("[A-Za-z]","[0-9]","[\\+\\-\\.]")+"*"),a(a(i+"|"+r(f,n,"[\\:]"))+"*"),a(a("25[0-5]")+"|"+a("2[0-4][0-9]")+"|"+a("1[0-9][0-9]")+"|"+a("0?[1-9][0-9]")+"|0?0?[0-9]")),u=a(l+"\\."+l+"\\."+l+"\\."+l),d=a(t+"{1,4}"),c=a(a(d+"\\:"+d)+"|"+u),v=a(a(d+"\\:")+"{6}"+c),h=a("\\:\\:"+a(d+"\\:")+"{5}"+c),m=a(a(d)+"?\\:\\:"+a(d+"\\:")+"{4}"+c),p=a(a(a(d+"\\:")+"{0,1}"+d)+"?\\:\\:"+a(d+"\\:")+"{3}"+c),y=a(a(a(d+"\\:")+"{0,2}"+d)+"?\\:\\:"+a(d+"\\:")+"{2}"+c),E=a(a(a(d+"\\:")+"{0,3}"+d)+"?\\:\\:"+d+"\\:"+c),g=a(a(a(d+"\\:")+"{0,4}"+d)+"?\\:\\:"+c),b=a(a(a(d+"\\:")+"{0,5}"+d)+"?\\:\\:"+d),_=a(a(a(d+"\\:")+"{0,6}"+d)+"?\\:\\:"),P=a([v,h,m,p,y,E,g,b,_].join("|")),F=a(a(f+"|"+i)+"+"),$=(a("[vV]"+t+"+\\."+r(f,n,"[\\:]")+"+"),a(a(i+"|"+r(f,n))+"*"),a(i+"|"+r(f,n,"[\\:\\@]")));return a(a(i+"|"+r(f,n,"[\\@]"))+"+"),a(a($+"|"+r("[\\/\\?]",s))+"*"),{NOT_SCHEME:RegExp(r("[^]","[A-Za-z]","[0-9]","[\\+\\-\\.]"),"g"),NOT_USERINFO:RegExp(r("[^\\%\\:]",f,n),"g"),NOT_HOST:RegExp(r("[^\\%\\[\\]\\:]",f,n),"g"),NOT_PATH:RegExp(r("[^\\%\\/\\:\\@]",f,n),"g"),NOT_PATH_NOSCHEME:RegExp(r("[^\\%\\/\\@]",f,n),"g"),NOT_QUERY:RegExp(r("[^\\%]",f,n,"[\\:\\@\\/\\?]",s),"g"),NOT_FRAGMENT:RegExp(r("[^\\%]",f,n,"[\\:\\@\\/\\?]"),"g"),ESCAPE:RegExp(r("[^]",f,n),"g"),UNRESERVED:RegExp(f,"g"),OTHER_CHARS:RegExp(r("[^\\%]",f,o),"g"),PCT_ENCODED:RegExp(i,"g"),IPV4ADDRESS:RegExp("^("+u+")$"),IPV6ADDRESS:RegExp("^\\[?("+P+")"+a(a("\\%25|\\%(?!"+t+"{2})")+"("+F+")")+"?\\]?$")}}var o=n(!1),s=n(!0),f=function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,r){var a=[],t=!0,i=!1,n=void 0;try{for(var o,s=e[Symbol.iterator]();!(t=(o=s.next()).done)&&(a.push(o.value),!r||a.length!==r);t=!0);}catch(e){i=!0,n=e}finally{try{!t&&s.return&&s.return()}finally{if(i)throw n}}return a}(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")},l=2147483647,u=/^xn--/,d=/[^\0-\x7E]/,c=/[\x2E\u3002\uFF0E\uFF61]/g,v={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},h=Math.floor,m=String.fromCharCode;function p(e){throw new RangeError(v[e])}function y(e,r){var a=e.split("@"),t="";a.length>1&&(t=a[0]+"@",e=a[1]);var i=function(e,r){for(var a=[],t=e.length;t--;)a[t]=r(e[t]);return a}((e=e.replace(c,".")).split("."),r).join(".");return t+i}function E(e){for(var r=[],a=0,t=e.length;a<t;){var i=e.charCodeAt(a++);if(i>=55296&&i<=56319&&a<t){var n=e.charCodeAt(a++);56320==(64512&n)?r.push(((1023&i)<<10)+(1023&n)+65536):(r.push(i),a--)}else r.push(i)}return r}var g=function(e,r){return e+22+75*(e<26)-((0!=r)<<5)},b=function(e,r,a){var t=0;for(e=a?h(e/700):e>>1,e+=h(e/r);e>455;t+=36)e=h(e/35);return h(t+36*e/(e+38))},_=function(e){var r,a=[],t=e.length,i=0,n=128,o=72,s=e.lastIndexOf("-");s<0&&(s=0);for(var f=0;f<s;++f)e.charCodeAt(f)>=128&&p("not-basic"),a.push(e.charCodeAt(f));for(var u=s>0?s+1:0;u<t;){for(var d=i,c=1,v=36;;v+=36){u>=t&&p("invalid-input");var m=(r=e.charCodeAt(u++))-48<10?r-22:r-65<26?r-65:r-97<26?r-97:36;(m>=36||m>h((l-i)/c))&&p("overflow"),i+=m*c;var y=v<=o?1:v>=o+26?26:v-o;if(m<y)break;var E=36-y;c>h(l/E)&&p("overflow"),c*=E}var g=a.length+1;o=b(i-d,g,0==d),h(i/g)>l-n&&p("overflow"),n+=h(i/g),i%=g,a.splice(i++,0,n)}return String.fromCodePoint.apply(String,a)},P=function(e){var r=[],a=(e=E(e)).length,t=128,i=0,n=72,o=!0,s=!1,f=void 0;try{for(var u,d=e[Symbol.iterator]();!(o=(u=d.next()).done);o=!0){var c=u.value;c<128&&r.push(m(c))}}catch(e){s=!0,f=e}finally{try{!o&&d.return&&d.return()}finally{if(s)throw f}}var v=r.length,y=v;for(v&&r.push("-");y<a;){var _=l,P=!0,F=!1,$=void 0;try{for(var w,O=e[Symbol.iterator]();!(P=(w=O.next()).done);P=!0){var A=w.value;A>=t&&A<_&&(_=A)}}catch(e){F=!0,$=e}finally{try{!P&&O.return&&O.return()}finally{if(F)throw $}}var I=y+1;_-t>h((l-i)/I)&&p("overflow"),i+=(_-t)*I,t=_;var S=!0,R=!1,j=void 0;try{for(var T,D=e[Symbol.iterator]();!(S=(T=D.next()).done);S=!0){var x=T.value;if(x<t&&++i>l&&p("overflow"),x==t){for(var N=i,k=36;;k+=36){var C=k<=n?1:k>=n+26?26:k-n;if(N<C)break;var z=N-C,M=36-C;r.push(m(g(C+z%M,0))),N=h(z/M)}r.push(m(g(N,0))),n=b(i,I,y==v),i=0,++y}}}catch(e){R=!0,j=e}finally{try{!S&&D.return&&D.return()}finally{if(R)throw j}}++i,++t}return r.join("")},F=function(e){return y(e,(function(e){return d.test(e)?"xn--"+P(e):e}))},$=function(e){return y(e,(function(e){return u.test(e)?_(e.slice(4).toLowerCase()):e}))},w={};function O(e){var r=e.charCodeAt(0);return r<16?"%0"+r.toString(16).toUpperCase():r<128?"%"+r.toString(16).toUpperCase():r<2048?"%"+(r>>6|192).toString(16).toUpperCase()+"%"+(63&r|128).toString(16).toUpperCase():"%"+(r>>12|224).toString(16).toUpperCase()+"%"+(r>>6&63|128).toString(16).toUpperCase()+"%"+(63&r|128).toString(16).toUpperCase()}function A(e){for(var r="",a=0,t=e.length;a<t;){var i=parseInt(e.substr(a+1,2),16);if(i<128)r+=String.fromCharCode(i),a+=3;else if(i>=194&&i<224){if(t-a>=6){var n=parseInt(e.substr(a+4,2),16);r+=String.fromCharCode((31&i)<<6|63&n)}else r+=e.substr(a,6);a+=6}else if(i>=224){if(t-a>=9){var o=parseInt(e.substr(a+4,2),16),s=parseInt(e.substr(a+7,2),16);r+=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}else r+=e.substr(a,9);a+=9}else r+=e.substr(a,3),a+=3}return r}function I(e,r){function a(e){var a=A(e);return a.match(r.UNRESERVED)?a:e}return e.scheme&&(e.scheme=(e.scheme+"").replace(r.PCT_ENCODED,a).toLowerCase().replace(r.NOT_SCHEME,"")),void 0!==e.userinfo&&(e.userinfo=(e.userinfo+"").replace(r.PCT_ENCODED,a).replace(r.NOT_USERINFO,O).replace(r.PCT_ENCODED,i)),void 0!==e.host&&(e.host=(e.host+"").replace(r.PCT_ENCODED,a).toLowerCase().replace(r.NOT_HOST,O).replace(r.PCT_ENCODED,i)),void 0!==e.path&&(e.path=(e.path+"").replace(r.PCT_ENCODED,a).replace(e.scheme?r.NOT_PATH:r.NOT_PATH_NOSCHEME,O).replace(r.PCT_ENCODED,i)),void 0!==e.query&&(e.query=(e.query+"").replace(r.PCT_ENCODED,a).replace(r.NOT_QUERY,O).replace(r.PCT_ENCODED,i)),void 0!==e.fragment&&(e.fragment=(e.fragment+"").replace(r.PCT_ENCODED,a).replace(r.NOT_FRAGMENT,O).replace(r.PCT_ENCODED,i)),e}function S(e){return e.replace(/^0*(.*)/,"$1")||"0"}function R(e,r){var a=e.match(r.IPV4ADDRESS)||[],t=f(a,2)[1];return t?t.split(".").map(S).join("."):e}function j(e,r){var a=e.match(r.IPV6ADDRESS)||[],t=f(a,3),i=t[1],n=t[2];if(i){for(var o=i.toLowerCase().split("::").reverse(),s=f(o,2),l=s[0],u=s[1],d=u?u.split(":").map(S):[],c=l.split(":").map(S),v=r.IPV4ADDRESS.test(c[c.length-1]),h=v?7:8,m=c.length-h,p=Array(h),y=0;y<h;++y)p[y]=d[y]||c[m+y]||"";v&&(p[h-1]=R(p[h-1],r));var E=p.reduce((function(e,r,a){if(!r||"0"===r){var t=e[e.length-1];t&&t.index+t.length===a?t.length++:e.push({index:a,length:1})}return e}),[]).sort((function(e,r){return r.length-e.length}))[0],g=void 0;if(E&&E.length>1){var b=p.slice(0,E.index),_=p.slice(E.index+E.length);g=b.join(":")+"::"+_.join(":")}else g=p.join(":");return n&&(g+="%"+n),g}return e}var T=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,D=void 0==="".match(/(){0}/)[1];function x(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a={},t=!1!==r.iri?s:o;"suffix"===r.reference&&(e=(r.scheme?r.scheme+":":"")+"//"+e);var i=e.match(T);if(i){D?(a.scheme=i[1],a.userinfo=i[3],a.host=i[4],a.port=parseInt(i[5],10),a.path=i[6]||"",a.query=i[7],a.fragment=i[8],isNaN(a.port)&&(a.port=i[5])):(a.scheme=i[1]||void 0,a.userinfo=-1!==e.indexOf("@")?i[3]:void 0,a.host=-1!==e.indexOf("//")?i[4]:void 0,a.port=parseInt(i[5],10),a.path=i[6]||"",a.query=-1!==e.indexOf("?")?i[7]:void 0,a.fragment=-1!==e.indexOf("#")?i[8]:void 0,isNaN(a.port)&&(a.port=e.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?i[4]:void 0)),a.host&&(a.host=j(R(a.host,t),t)),a.reference=void 0!==a.scheme||void 0!==a.userinfo||void 0!==a.host||void 0!==a.port||a.path||void 0!==a.query?void 0===a.scheme?"relative":void 0===a.fragment?"absolute":"uri":"same-document",r.reference&&"suffix"!==r.reference&&r.reference!==a.reference&&(a.error=a.error||"URI is not a "+r.reference+" reference.");var n=w[(r.scheme||a.scheme||"").toLowerCase()];if(r.unicodeSupport||n&&n.unicodeSupport)I(a,t);else{if(a.host&&(r.domainHost||n&&n.domainHost))try{a.host=F(a.host.replace(t.PCT_ENCODED,A).toLowerCase())}catch(e){a.error=a.error||"Host's domain name can not be converted to ASCII via punycode: "+e}I(a,o)}n&&n.parse&&n.parse(a,r)}else a.error=a.error||"URI can not be parsed.";return a}function N(e,r){var a=!1!==r.iri?s:o,t=[];return void 0!==e.userinfo&&(t.push(e.userinfo),t.push("@")),void 0!==e.host&&t.push(j(R(e.host+"",a),a).replace(a.IPV6ADDRESS,(function(e,r,a){return"["+r+(a?"%25"+a:"")+"]"}))),"number"==typeof e.port&&(t.push(":"),t.push(e.port.toString(10))),t.length?t.join(""):void 0}var k=/^\.\.?\//,C=/^\/\.(\/|$)/,z=/^\/\.\.(\/|$)/,M=/^\/?(?:.|\n)*?(?=\/|$)/;function V(e){for(var r=[];e.length;)if(e.match(k))e=e.replace(k,"");else if(e.match(C))e=e.replace(C,"/");else if(e.match(z))e=e.replace(z,"/"),r.pop();else if("."===e||".."===e)e="";else{var a=e.match(M);if(!a)throw Error("Unexpected dot segment condition");var t=a[0];e=e.slice(t.length),r.push(t)}return r.join("")}function U(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=r.iri?s:o,t=[],i=w[(r.scheme||e.scheme||"").toLowerCase()];if(i&&i.serialize&&i.serialize(e,r),e.host)if(a.IPV6ADDRESS.test(e.host));else if(r.domainHost||i&&i.domainHost)try{e.host=r.iri?$(e.host):F(e.host.replace(a.PCT_ENCODED,A).toLowerCase())}catch(a){e.error=e.error||"Host's domain name can not be converted to "+(r.iri?"Unicode":"ASCII")+" via punycode: "+a}I(e,a),"suffix"!==r.reference&&e.scheme&&(t.push(e.scheme),t.push(":"));var n=N(e,r);if(void 0!==n&&("suffix"!==r.reference&&t.push("//"),t.push(n),e.path&&"/"!==e.path.charAt(0)&&t.push("/")),void 0!==e.path){var f=e.path;r.absolutePath||i&&i.absolutePath||(f=V(f)),void 0===n&&(f=f.replace(/^\/\//,"/%2F")),t.push(f)}return void 0!==e.query&&(t.push("?"),t.push(e.query)),void 0!==e.fragment&&(t.push("#"),t.push(e.fragment)),t.join("")}function q(e,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},t=arguments[3],i={};return t||(e=x(U(e,a),a),r=x(U(r,a),a)),!(a=a||{}).tolerant&&r.scheme?(i.scheme=r.scheme,i.userinfo=r.userinfo,i.host=r.host,i.port=r.port,i.path=V(r.path||""),i.query=r.query):(void 0!==r.userinfo||void 0!==r.host||void 0!==r.port?(i.userinfo=r.userinfo,i.host=r.host,i.port=r.port,i.path=V(r.path||""),i.query=r.query):(r.path?("/"===r.path.charAt(0)?i.path=V(r.path):(i.path=void 0===e.userinfo&&void 0===e.host&&void 0===e.port||e.path?e.path?e.path.slice(0,e.path.lastIndexOf("/")+1)+r.path:r.path:"/"+r.path,i.path=V(i.path)),i.query=r.query):(i.path=e.path,i.query=void 0!==r.query?r.query:e.query),i.userinfo=e.userinfo,i.host=e.host,i.port=e.port),i.scheme=e.scheme),i.fragment=r.fragment,i}function L(e,r){return e&&(""+e).replace(r&&r.iri?s.PCT_ENCODED:o.PCT_ENCODED,A)}var H={scheme:"http",domainHost:!0,parse:function(e,r){return e.host||(e.error=e.error||"HTTP URIs must have a host."),e},serialize:function(e,r){return e.port!==("https"!==(e.scheme+"").toLowerCase()?80:443)&&""!==e.port||(e.port=void 0),e.path||(e.path="/"),e}},J={scheme:"https",domainHost:H.domainHost,parse:H.parse,serialize:H.serialize},K={},G="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",Y="[0-9A-Fa-f]",B=a(a("%[EFef]"+Y+"%"+Y+Y+"%"+Y+Y)+"|"+a("%[89A-Fa-f]"+Y+"%"+Y+Y)+"|"+a("%"+Y+Y)),Z=r("[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",'[\\"\\\\]'),Q=/[A-Za-z0-9\-\.\_\~\xA0-\u200D\u2010-\u2029\u202F-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]/g,X=RegExp(B,"g"),W=RegExp(r("[^]","[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]","[\\.]",'[\\"]',Z),"g"),ee=RegExp(r("[^]",G,"[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]"),"g"),re=ee;function ae(e){var r=A(e);return r.match(Q)?r:e}var te={scheme:"mailto",parse:function(e,r){var a=e,t=a.to=a.path?a.path.split(","):[];if(a.path=void 0,a.query){for(var i=!1,n={},o=a.query.split("&"),s=0,f=o.length;s<f;++s){var l=o[s].split("=");switch(l[0]){case"to":for(var u=l[1].split(","),d=0,c=u.length;d<c;++d)t.push(u[d]);break;case"subject":a.subject=L(l[1],r);break;case"body":a.body=L(l[1],r);break;default:i=!0,n[L(l[0],r)]=L(l[1],r)}}i&&(a.headers=n)}a.query=void 0;for(var v=0,h=t.length;v<h;++v){var m=t[v].split("@");if(m[0]=L(m[0]),r.unicodeSupport)m[1]=L(m[1],r).toLowerCase();else try{m[1]=F(L(m[1],r).toLowerCase())}catch(e){a.error=a.error||"Email address's domain name can not be converted to ASCII via punycode: "+e}t[v]=m.join("@")}return a},serialize:function(e,r){var a,t=e,n=null!=(a=e.to)?a instanceof Array?a:"number"!=typeof a.length||a.split||a.setInterval||a.call?[a]:Array.prototype.slice.call(a):[];if(n){for(var o=0,s=n.length;o<s;++o){var f=n[o]+"",l=f.lastIndexOf("@"),u=f.slice(0,l).replace(X,ae).replace(X,i).replace(W,O),d=f.slice(l+1);try{d=r.iri?$(d):F(L(d,r).toLowerCase())}catch(e){t.error=t.error||"Email address's domain name can not be converted to "+(r.iri?"Unicode":"ASCII")+" via punycode: "+e}n[o]=u+"@"+d}t.path=n.join(",")}var c=e.headers=e.headers||{};e.subject&&(c.subject=e.subject),e.body&&(c.body=e.body);var v=[];for(var h in c)c[h]!==K[h]&&v.push(h.replace(X,ae).replace(X,i).replace(ee,O)+"="+c[h].replace(X,ae).replace(X,i).replace(re,O));return v.length&&(t.query=v.join("&")),t}},ie=/^([^\:]+)\:(.*)/,ne={scheme:"urn",parse:function(e,r){var a=e.path&&e.path.match(ie),t=e;if(a){var i=r.scheme||t.scheme||"urn",n=a[1].toLowerCase(),o=a[2],s=w[i+":"+(r.nid||n)];t.nid=n,t.nss=o,t.path=void 0,s&&(t=s.parse(t,r))}else t.error=t.error||"URN can not be parsed.";return t},serialize:function(e,r){var a=e.nid,t=w[(r.scheme||e.scheme||"urn")+":"+(r.nid||a)];t&&(e=t.serialize(e,r));var i=e;return i.path=(a||r.nid)+":"+e.nss,i}},oe=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,se={scheme:"urn:uuid",parse:function(e,r){var a=e;return a.uuid=a.nss,a.nss=void 0,r.tolerant||a.uuid&&a.uuid.match(oe)||(a.error=a.error||"UUID is not valid."),a},serialize:function(e,r){var a=e;return a.nss=(e.uuid||"").toLowerCase(),a}};w[H.scheme]=H,w[J.scheme]=J,w[te.scheme]=te,w[ne.scheme]=ne,w[se.scheme]=se,e.SCHEMES=w,e.pctEncChar=O,e.pctDecChars=A,e.parse=x,e.removeDotSegments=V,e.serialize=U,e.resolveComponents=q,e.resolve=function(e,r,a){var t=function(e,r){var a=e;if(r)for(var t in r)a[t]=r[t];return a}({scheme:"null"},a);return U(q(x(e,t),x(r,t),t,!0),t)},e.normalize=function(e,r){return"string"==typeof e?e=U(x(e,r),r):"object"===t(e)&&(e=x(U(e,r),r)),e},e.equal=function(e,r,a){return"string"==typeof e?e=U(x(e,a),a):"object"===t(e)&&(e=U(e,a)),"string"==typeof r?r=U(x(r,a),a):"object"===t(r)&&(r=U(r,a)),e===r},e.escapeComponent=function(e,r){return e&&(""+e).replace(r&&r.iri?s.ESCAPE:o.ESCAPE,O)},e.unescapeComponent=L,Object.defineProperty(e,"__esModule",{value:!0})}(r)}));unwrapExports(uri_all);var fastDeepEqual=function e(r,a){if(r===a)return!0;if(r&&a&&"object"==typeof r&&"object"==typeof a){if(r.constructor!==a.constructor)return!1;var t,i,n;if(Array.isArray(r)){if((t=r.length)!=a.length)return!1;for(i=t;0!=i--;)if(!e(r[i],a[i]))return!1;return!0}if(r.constructor===RegExp)return r.source===a.source&&r.flags===a.flags;if(r.valueOf!==Object.prototype.valueOf)return r.valueOf()===a.valueOf();if(r.toString!==Object.prototype.toString)return""+r==""+a;if((t=(n=Object.keys(r)).length)!==Object.keys(a).length)return!1;for(i=t;0!=i--;)if(!Object.prototype.hasOwnProperty.call(a,n[i]))return!1;for(i=t;0!=i--;){var o=n[i];if(!e(r[o],a[o]))return!1}return!0}return r!=r&&a!=a},ucs2length=function(e){for(var r,a=0,t=e.length,i=0;i<t;)a++,(r=e.charCodeAt(i++))>=55296&&r<=56319&&i<t&&56320==(64512&(r=e.charCodeAt(i)))&&i++;return a},util={copy,checkDataType,checkDataTypes,coerceToTypes,toHash,getProperty,escapeQuotes,equal:fastDeepEqual,ucs2length,varOccurences,varReplace,cleanUpCode,finalCleanUpCode,schemaHasRules,schemaHasRulesExcept,schemaUnknownRules,toQuotedString,getPathExpr,getPath,getData,unescapeFragment,unescapeJsonPointer,escapeFragment,escapeJsonPointer};function copy(e,r){for(var a in r=r||{},e)r[a]=e[a];return r}function checkDataType(e,r,a){var t=a?" !== ":" === ",i=a?" || ":" && ",n=a?"!":"",o=a?"":"!";switch(e){case"null":return r+t+"null";case"array":return n+"Array.isArray("+r+")";case"object":return"("+n+r+i+"typeof "+r+t+'"object"'+i+o+"Array.isArray("+r+"))";case"integer":return"(typeof "+r+t+'"number"'+i+o+"("+r+" % 1)"+i+r+t+r+")";default:return"typeof "+r+t+'"'+e+'"'}}function checkDataTypes(e,r){switch(e.length){case 1:return checkDataType(e[0],r,!0);default:var a="",t=toHash(e);for(var i in t.array&&t.object&&(a=t.null?"(":"(!"+r+" || ",a+="typeof "+r+' !== "object")',delete t.null,delete t.array,delete t.object),t.number&&delete t.integer,t)a+=(a?" && ":"")+checkDataType(i,r,!0);return a}}var COERCE_TO_TYPES=toHash(["string","number","integer","boolean","null"]);function coerceToTypes(e,r){if(Array.isArray(r)){for(var a=[],t=0;t<r.length;t++){var i=r[t];(COERCE_TO_TYPES[i]||"array"===e&&"array"===i)&&(a[a.length]=i)}if(a.length)return a}else{if(COERCE_TO_TYPES[r])return[r];if("array"===e&&"array"===r)return["array"]}}function toHash(e){for(var r={},a=0;a<e.length;a++)r[e[a]]=!0;return r}var IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i,SINGLE_QUOTE=/'|\\/g;function getProperty(e){return"number"==typeof e?"["+e+"]":IDENTIFIER.test(e)?"."+e:"['"+escapeQuotes(e)+"']"}function escapeQuotes(e){return e.replace(SINGLE_QUOTE,"\\$&").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\f/g,"\\f").replace(/\t/g,"\\t")}function varOccurences(e,r){var a=e.match(RegExp(r+="[^0-9]","g"));return a?a.length:0}function varReplace(e,r,a){return r+="([^0-9])",a=a.replace(/\$/g,"$$$$"),e.replace(RegExp(r,"g"),a+"$1")}var EMPTY_ELSE=/else\s*{\s*}/g,EMPTY_IF_NO_ELSE=/if\s*\([^)]+\)\s*\{\s*\}(?!\s*else)/g,EMPTY_IF_WITH_ELSE=/if\s*\(([^)]+)\)\s*\{\s*\}\s*else(?!\s*if)/g;function cleanUpCode(e){return e.replace(EMPTY_ELSE,"").replace(EMPTY_IF_NO_ELSE,"").replace(EMPTY_IF_WITH_ELSE,"if (!($1))")}var ERRORS_REGEXP=/[^v.]errors/g,REMOVE_ERRORS=/var errors = 0;|var vErrors = null;|validate.errors = vErrors;/g,REMOVE_ERRORS_ASYNC=/var errors = 0;|var vErrors = null;/g,RETURN_VALID="return errors === 0;",RETURN_TRUE="validate.errors = null; return true;",RETURN_ASYNC=/if \(errors === 0\) return data;\s*else throw new ValidationError\(vErrors\);/,RETURN_DATA_ASYNC="return data;",ROOTDATA_REGEXP=/[^A-Za-z_$]rootData[^A-Za-z0-9_$]/g,REMOVE_ROOTDATA=/if \(rootData === undefined\) rootData = data;/;function finalCleanUpCode(e,r){var a=e.match(ERRORS_REGEXP);return a&&2==a.length&&(e=r?e.replace(REMOVE_ERRORS_ASYNC,"").replace(RETURN_ASYNC,RETURN_DATA_ASYNC):e.replace(REMOVE_ERRORS,"").replace(RETURN_VALID,RETURN_TRUE)),(a=e.match(ROOTDATA_REGEXP))&&3===a.length?e.replace(REMOVE_ROOTDATA,""):e}function schemaHasRules(e,r){if("boolean"==typeof e)return!e;for(var a in e)if(r[a])return!0}function schemaHasRulesExcept(e,r,a){if("boolean"==typeof e)return!e&&"not"!=a;for(var t in e)if(t!=a&&r[t])return!0}function schemaUnknownRules(e,r){if("boolean"!=typeof e)for(var a in e)if(!r[a])return a}function toQuotedString(e){return"'"+escapeQuotes(e)+"'"}function getPathExpr(e,r,a,t){return joinPaths(e,a?"'/' + "+r+(t?"":".replace(/~/g, '~0').replace(/\\//g, '~1')"):t?"'[' + "+r+" + ']'":"'[\\'' + "+r+" + '\\']'")}function getPath(e,r,a){return joinPaths(e,toQuotedString(a?"/"+escapeJsonPointer(r):getProperty(r)))}var JSON_POINTER=/^\/(?:[^~]|~0|~1)*$/,RELATIVE_JSON_POINTER=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function getData(e,r,a){var t,i,n,o;if(""===e)return"rootData";if("/"==e[0]){if(!JSON_POINTER.test(e))throw Error("Invalid JSON-pointer: "+e);i=e,n="rootData"}else{if(!(o=e.match(RELATIVE_JSON_POINTER)))throw Error("Invalid JSON-pointer: "+e);if(t=+o[1],"#"==(i=o[2])){if(t>=r)throw Error("Cannot access property/index "+t+" levels up, current level is "+r);return a[r-t]}if(t>r)throw Error("Cannot access data "+t+" levels up, current level is "+r);if(n="data"+(r-t||""),!i)return n}for(var s=n,f=i.split("/"),l=0;l<f.length;l++){var u=f[l];u&&(s+=" && "+(n+=getProperty(unescapeJsonPointer(u))))}return s}function joinPaths(e,r){return'""'==e?r:(e+" + "+r).replace(/' \+ '/g,"")}function unescapeFragment(e){return unescapeJsonPointer(decodeURIComponent(e))}function escapeFragment(e){return encodeURIComponent(escapeJsonPointer(e))}function escapeJsonPointer(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}function unescapeJsonPointer(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}var schema_obj=SchemaObject;function SchemaObject(e){util.copy(e,this)}var jsonSchemaTraverse=createCommonjsModule((function(e){var r=e.exports=function(e,a,t){"function"==typeof a&&(t=a,a={}),function e(a,t,i,n,o,s,f,l,u,d){if(n&&"object"==typeof n&&!Array.isArray(n)){for(var c in t(n,o,s,f,l,u,d),n){var v=n[c];if(Array.isArray(v)){if(c in r.arrayKeywords)for(var h=0;h<v.length;h++)e(a,t,i,v[h],o+"/"+c+"/"+h,s,o,c,n,h)}else if(c in r.propsKeywords){if(v&&"object"==typeof v)for(var m in v)e(a,t,i,v[m],o+"/"+c+"/"+m.replace(/~/g,"~0").replace(/\//g,"~1"),s,o,c,n,m)}else(c in r.keywords||a.allKeys&&!(c in r.skipKeywords))&&e(a,t,i,v,o+"/"+c,s,o,c,n)}i(n,o,s,f,l,u,d)}}(a,"function"==typeof(t=a.cb||t)?t:t.pre||function(){},t.post||function(){},e,"",e)};r.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0},r.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},r.propsKeywords={definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},r.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0}})),resolve_1=resolve;function resolve(e,r,a){var t=this._refs[a];if("string"==typeof t){if(!this._refs[t])return resolve.call(this,e,r,t);t=this._refs[t]}if((t=t||this._schemas[a])instanceof schema_obj)return inlineRef(t.schema,this._opts.inlineRefs)?t.schema:t.validate||this._compile(t);var i,n,o,s=resolveSchema.call(this,r,a);return s&&(i=s.schema,r=s.root,o=s.baseId),i instanceof schema_obj?n=i.validate||e.call(this,i.schema,r,void 0,o):void 0!==i&&(n=inlineRef(i,this._opts.inlineRefs)?i:e.call(this,i,r,void 0,o)),n}function resolveSchema(e,r){var a=uri_all.parse(r),t=_getFullPath(a),i=getFullPath(this._getId(e.schema));if(0===Object.keys(e.schema).length||t!==i){var n=normalizeId(t),o=this._refs[n];if("string"==typeof o)return resolveRecursive.call(this,e,o,a);if(o instanceof schema_obj)o.validate||this._compile(o),e=o;else{if(!((o=this._schemas[n])instanceof schema_obj))return;if(o.validate||this._compile(o),n==normalizeId(r))return{schema:o,root:e,baseId:i};e=o}if(!e.schema)return;i=getFullPath(this._getId(e.schema))}return getJsonPointer.call(this,a,i,e.schema,e)}function resolveRecursive(e,r,a){var t=resolveSchema.call(this,e,r);if(t){var i=t.schema,n=t.baseId;e=t.root;var o=this._getId(i);return o&&(n=resolveUrl(n,o)),getJsonPointer.call(this,a,n,i,e)}}resolve.normalizeId=normalizeId,resolve.fullPath=getFullPath,resolve.url=resolveUrl,resolve.ids=resolveIds,resolve.inlineRef=inlineRef,resolve.schema=resolveSchema;var PREVENT_SCOPE_CHANGE=util.toHash(["properties","patternProperties","enum","dependencies","definitions"]);function getJsonPointer(e,r,a,t){if(e.fragment=e.fragment||"","/"==e.fragment.slice(0,1)){for(var i=e.fragment.split("/"),n=1;n<i.length;n++){var o=i[n];if(o){if(void 0===(a=a[o=util.unescapeFragment(o)]))break;var s;if(!PREVENT_SCOPE_CHANGE[o]&&((s=this._getId(a))&&(r=resolveUrl(r,s)),a.o)){var f=resolveUrl(r,a.o),l=resolveSchema.call(this,t,f);l&&(a=l.schema,t=l.root,r=l.baseId)}}}return void 0!==a&&a!==t.schema?{schema:a,root:t,baseId:r}:void 0}}var SIMPLE_INLINED=util.toHash(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum"]);function inlineRef(e,r){return!1!==r&&(void 0===r||!0===r?checkNoRef(e):r?countKeys(e)<=r:void 0)}function checkNoRef(e){var r;if(Array.isArray(e)){for(var a=0;a<e.length;a++)if("object"==typeof(r=e[a])&&!checkNoRef(r))return!1}else for(var t in e){if("$ref"==t)return!1;if("object"==typeof(r=e[t])&&!checkNoRef(r))return!1}return!0}function countKeys(e){var r,a=0;if(Array.isArray(e)){for(var t=0;t<e.length;t++)if("object"==typeof(r=e[t])&&(a+=countKeys(r)),Infinity==a)return Infinity}else for(var i in e){if("$ref"==i)return Infinity;if(SIMPLE_INLINED[i])a++;else if("object"==typeof(r=e[i])&&(a+=countKeys(r)+1),Infinity==a)return Infinity}return a}function getFullPath(e,r){return!1!==r&&(e=normalizeId(e)),_getFullPath(uri_all.parse(e))}function _getFullPath(e){return uri_all.serialize(e).split("#")[0]+"#"}var TRAILING_SLASH_HASH=/#\/?$/;function normalizeId(e){return e?e.replace(TRAILING_SLASH_HASH,""):""}function resolveUrl(e,r){return r=normalizeId(r),uri_all.resolve(e,r)}function resolveIds(e){var r=normalizeId(this._getId(e)),a={"":r},t={"":getFullPath(r,!1)},i={},n=this;return jsonSchemaTraverse(e,{allKeys:!0},(function(e,r,o,s,f,l,u){if(""!==r){var d=n._getId(e),c=a[s],v=t[s]+"/"+f;if(void 0!==u&&(v+="/"+("number"==typeof u?u:util.escapeFragment(u))),"string"==typeof d){d=c=normalizeId(c?uri_all.resolve(c,d):d);var h=n._refs[d];if("string"==typeof h&&(h=n._refs[h]),h&&h.schema){if(!fastDeepEqual(e,h.schema))throw Error('id "'+d+'" resolves to more than one schema')}else if(d!=normalizeId(v))if("#"==d[0]){if(i[d]&&!fastDeepEqual(e,i[d]))throw Error('id "'+d+'" resolves to more than one schema');i[d]=e}else n._refs[d]=v}a[r]=c,t[r]=v}})),i}var error_classes={Validation:errorSubclass(ValidationError),MissingRef:errorSubclass(MissingRefError)};function ValidationError(e){this.message="validation failed",this.errors=e,this.ajv=this.validation=!0}function MissingRefError(e,r,a){this.message=a||MissingRefError.message(e,r),this.missingRef=resolve_1.url(e,r),this.missingSchema=resolve_1.normalizeId(resolve_1.fullPath(this.missingRef))}function errorSubclass(e){return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}MissingRefError.message=function(e,r){return"can't resolve reference "+r+" from id "+e};var fastJsonStableStringify=function(e,r){r||(r={}),"function"==typeof r&&(r={cmp:r});var a,t="boolean"==typeof r.cycles&&r.cycles,i=r.cmp&&(a=r.cmp,function(e){return function(r,t){return a({key:r,value:e[r]},{key:t,value:e[t]})}}),n=[];return function e(r){if(r&&r.toJSON&&"function"==typeof r.toJSON&&(r=r.toJSON()),void 0!==r){if("number"==typeof r)return isFinite(r)?""+r:"null";if("object"!=typeof r)return JSON.stringify(r);var a,o;if(Array.isArray(r)){for(o="[",a=0;a<r.length;a++)a&&(o+=","),o+=e(r[a])||"null";return o+"]"}if(null===r)return"null";if(-1!==n.indexOf(r)){if(t)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var s=n.push(r)-1,f=Object.keys(r).sort(i&&i(r));for(o="",a=0;a<f.length;a++){var l=f[a],u=e(r[l]);u&&(o&&(o+=","),o+=JSON.stringify(l)+":"+u)}return n.splice(s,1),"{"+o+"}"}}(e)},validate=function(e,r,a){var t="",i=!0===e.schema.s,n=e.util.schemaHasRulesExcept(e.schema,e.RULES.all,"$ref"),o=e.self._getId(e.schema);if(e.opts.strictKeywords){var s=e.util.schemaUnknownRules(e.schema,e.RULES.keywords);if(s){var f="unknown keyword: "+s;if("log"!==e.opts.strictKeywords)throw Error(f);e.logger.warn(f)}}if(e.isTop&&(t+=" var validate = ",i&&(e.async=!0,t+="async "),t+="function(data, dataPath, parentData, parentDataProperty, rootData) { 'use strict'; ",o&&(e.opts.sourceCode||e.opts.processCode)&&(t+=" /*# sourceURL="+o+" */ ")),"boolean"==typeof e.schema||!n&&!e.schema.o){var l=e.level,u=e.dataLevel,d=e.schema["false schema"],c=e.schemaPath+e.util.getProperty("false schema"),v=e.errSchemaPath+"/false schema",h=!e.opts.allErrors,m="data"+(u||""),p="valid"+l;if(!1===e.schema){e.isTop?h=!0:t+=" var "+p+" = false; ",(Z=Z||[]).push(t),t="",!1!==e.createErrors?(t+=" { keyword: 'false schema' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(v)+" , params: {} ",!1!==e.opts.messages&&(t+=" , message: 'boolean schema is false' "),e.opts.verbose&&(t+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),t+=" } "):t+=" {} ";var y=t;t=Z.pop(),t+=!e.compositeRule&&h?e.async?" throw new ValidationError(["+y+"]); ":" validate.errors = ["+y+"]; return false; ":" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else t+=e.isTop?i?" return data; ":" validate.errors = null; return true; ":" var "+p+" = true; ";return e.isTop&&(t+=" }; return validate; "),t}if(e.isTop){var E=e.isTop;l=e.level=0,u=e.dataLevel=0,m="data";if(e.rootId=e.resolve.fullPath(e.self._getId(e.root.schema)),e.baseId=e.baseId||e.rootId,delete e.isTop,e.dataPathArr=[void 0],void 0!==e.schema.default&&e.opts.useDefaults&&e.opts.strictDefaults){var g="default is ignored in the schema root";if("log"!==e.opts.strictDefaults)throw Error(g);e.logger.warn(g)}t+=" var vErrors = null; ",t+=" var errors = 0;     ",t+=" if (rootData === undefined) rootData = data; "}else{l=e.level,m="data"+((u=e.dataLevel)||"");if(o&&(e.baseId=e.resolve.url(e.baseId,o)),i&&!e.async)throw Error("async schema in sync schema");t+=" var errs_"+l+" = errors;"}p="valid"+l,h=!e.opts.allErrors;var b="",_="",P=e.schema.type,F=Array.isArray(P);if(P&&e.opts.nullable&&!0===e.schema.nullable&&(F?-1==P.indexOf("null")&&(P=P.concat("null")):"null"!=P&&(P=[P,"null"],F=!0)),F&&1==P.length&&(P=P[0],F=!1),e.schema.o&&n){if("fail"==e.opts.extendRefs)throw Error('$ref: validation keywords used in schema at path "'+e.errSchemaPath+'" (see option extendRefs)');!0!==e.opts.extendRefs&&(n=!1,e.logger.warn('$ref: keywords ignored in schema at path "'+e.errSchemaPath+'"'))}if(e.schema.l&&e.opts.l&&(t+=" "+e.RULES.all.l.code(e,"$comment")),P){if(e.opts.coerceTypes)var $=e.util.coerceToTypes(e.opts.coerceTypes,P);var w=e.RULES.types[P];if($||F||!0===w||w&&!Q(w)){c=e.schemaPath+".type",v=e.errSchemaPath+"/type",c=e.schemaPath+".type",v=e.errSchemaPath+"/type";if(t+=" if ("+e.util[F?"checkDataTypes":"checkDataType"](P,m,!0)+") { ",$){var O="dataType"+l,A="coerced"+l;t+=" var "+O+" = typeof "+m+"; ","array"==e.opts.coerceTypes&&(t+=" if ("+O+" == 'object' && Array.isArray("+m+")) "+O+" = 'array'; "),t+=" var "+A+" = undefined; ";var I="",S=$;if(S)for(var R,j=-1,T=S.length-1;j<T;)R=S[j+=1],j&&(t+=" if ("+A+" === undefined) { ",I+="}"),"array"==e.opts.coerceTypes&&"array"!=R&&(t+=" if ("+O+" == 'array' && "+m+".length == 1) { "+A+" = "+m+" = "+m+"[0]; "+O+" = typeof "+m+";  } "),"string"==R?t+=" if ("+O+" == 'number' || "+O+" == 'boolean') "+A+" = '' + "+m+"; else if ("+m+" === null) "+A+" = ''; ":"number"==R||"integer"==R?(t+=" if ("+O+" == 'boolean' || "+m+" === null || ("+O+" == 'string' && "+m+" && "+m+" == +"+m+" ","integer"==R&&(t+=" && !("+m+" % 1)"),t+=")) "+A+" = +"+m+"; "):"boolean"==R?t+=" if ("+m+" === 'false' || "+m+" === 0 || "+m+" === null) "+A+" = false; else if ("+m+" === 'true' || "+m+" === 1) "+A+" = true; ":"null"==R?t+=" if ("+m+" === '' || "+m+" === 0 || "+m+" === false) "+A+" = null; ":"array"==e.opts.coerceTypes&&"array"==R&&(t+=" if ("+O+" == 'string' || "+O+" == 'number' || "+O+" == 'boolean' || "+m+" == null) "+A+" = ["+m+"]; ");(Z=Z||[]).push(t+=" "+I+" if ("+A+" === undefined) {   "),t="",!1!==e.createErrors?(t+=" { keyword: 'type' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(v)+" , params: { type: '",t+=F?""+P.join(","):""+P,t+="' } ",!1!==e.opts.messages&&(t+=" , message: 'should be ",t+=F?""+P.join(","):""+P,t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),t+=" } "):t+=" {} ";y=t;t=Z.pop(),t+=!e.compositeRule&&h?e.async?" throw new ValidationError(["+y+"]); ":" validate.errors = ["+y+"]; return false; ":" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } else {  ";var D=u?"data"+(u-1||""):"parentData";t+=" "+m+" = "+A+"; ",u||(t+="if ("+D+" !== undefined)"),t+=" "+D+"["+(u?e.dataPathArr[u]:"parentDataProperty")+"] = "+A+"; } "}else{(Z=Z||[]).push(t),t="",!1!==e.createErrors?(t+=" { keyword: 'type' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(v)+" , params: { type: '",t+=F?""+P.join(","):""+P,t+="' } ",!1!==e.opts.messages&&(t+=" , message: 'should be ",t+=F?""+P.join(","):""+P,t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),t+=" } "):t+=" {} ";y=t;t=Z.pop(),t+=!e.compositeRule&&h?e.async?" throw new ValidationError(["+y+"]); ":" validate.errors = ["+y+"]; return false; ":" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}t+=" } "}}if(e.schema.o&&!n)t+=" "+e.RULES.all.o.code(e,"$ref")+" ",h&&(t+=" } if (errors === ",t+=E?"0":"errs_"+l,t+=") { ",_+="}");else{var x=e.RULES;if(x)for(var N=-1,k=x.length-1;N<k;)if(Q(w=x[N+=1])){if(w.type&&(t+=" if ("+e.util.checkDataType(w.type,m)+") { "),e.opts.useDefaults)if("object"==w.type&&e.schema.properties){var C=Object.keys(d=e.schema.properties);if(C)for(var z,M=-1,V=C.length-1;M<V;){if(void 0!==(L=d[z=C[M+=1]]).default){var U=m+e.util.getProperty(z);if(e.compositeRule){if(e.opts.strictDefaults){g="default is ignored for: "+U;if("log"!==e.opts.strictDefaults)throw Error(g);e.logger.warn(g)}}else t+=" if ("+U+" === undefined ","empty"==e.opts.useDefaults&&(t+=" || "+U+" === null || "+U+" === '' "),t+=" ) "+U+" = ",t+="shared"==e.opts.useDefaults?" "+e.useDefault(L.default)+" ":" "+JSON.stringify(L.default)+" ",t+="; "}}}else if("array"==w.type&&Array.isArray(e.schema.items)){var q=e.schema.items;if(q){j=-1;for(var L,H=q.length-1;j<H;)if(void 0!==(L=q[j+=1]).default){U=m+"["+j+"]";if(e.compositeRule){if(e.opts.strictDefaults){g="default is ignored for: "+U;if("log"!==e.opts.strictDefaults)throw Error(g);e.logger.warn(g)}}else t+=" if ("+U+" === undefined ","empty"==e.opts.useDefaults&&(t+=" || "+U+" === null || "+U+" === '' "),t+=" ) "+U+" = ",t+="shared"==e.opts.useDefaults?" "+e.useDefault(L.default)+" ":" "+JSON.stringify(L.default)+" ",t+="; "}}}var J=w.rules;if(J)for(var K,G=-1,Y=J.length-1;G<Y;)if(X(K=J[G+=1])){var B=K.code(e,K.keyword,w.type);B&&(t+=" "+B+" ",h&&(b+="}"))}if(h&&(t+=" "+b+" ",b=""),w.type&&(t+=" } ",P&&P===w.type&&!$)){var Z;c=e.schemaPath+".type",v=e.errSchemaPath+"/type";(Z=Z||[]).push(t+=" else { "),t="",!1!==e.createErrors?(t+=" { keyword: 'type' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(v)+" , params: { type: '",t+=F?""+P.join(","):""+P,t+="' } ",!1!==e.opts.messages&&(t+=" , message: 'should be ",t+=F?""+P.join(","):""+P,t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),t+=" } "):t+=" {} ";y=t;t=Z.pop(),t+=!e.compositeRule&&h?e.async?" throw new ValidationError(["+y+"]); ":" validate.errors = ["+y+"]; return false; ":" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } "}h&&(t+=" if (errors === ",t+=E?"0":"errs_"+l,t+=") { ",_+="}")}}function Q(e){for(var r=e.rules,a=0;a<r.length;a++)if(X(r[a]))return!0}function X(r){return void 0!==e.schema[r.keyword]||r.implements&&function(r){for(var a=r.implements,t=0;t<a.length;t++)if(void 0!==e.schema[a[t]])return!0}(r)}return h&&(t+=" "+_+" "),E?(i?(t+=" if (errors === 0) return data;           ",t+=" else throw new ValidationError(vErrors); "):(t+=" validate.errors = vErrors; ",t+=" return errors === 0;       "),t+=" }; return validate;"):t+=" var "+p+" = errors === errs_"+l+";",t=e.util.cleanUpCode(t),E&&(t=e.util.finalCleanUpCode(t,i)),t},ucs2length$1=util.ucs2length,ValidationError$1=error_classes.Validation,compile_1=compile;function compile(e,r,a,t){var i=this,n=this._opts,o=[void 0],s={},f=[],l={},u=[],d={},c=[],v=checkCompiling.call(this,e,r=r||{schema:e,refVal:o,refs:s},t),h=this._compilations[v.index];if(v.compiling)return h.callValidate=function e(){var r=h.validate,a=r.apply(this,arguments);return e.errors=r.errors,a};var m=this._formats,p=this.RULES;try{var y=g(e,r,a,t);h.validate=y;var E=h.callValidate;return E&&(E.schema=y.schema,E.errors=null,E.refs=y.refs,E.refVal=y.refVal,E.root=y.root,E.s=y.s,n.sourceCode&&(E.source=y.source)),y}finally{endCompiling.call(this,e,r,t)}function g(e,a,t,l){var d=!a||a&&a.schema==e;if(a.schema!=r.schema)return compile.call(i,e,a,t,l);var v,h=!0===e.s,y=validate({isTop:!0,schema:e,isRoot:d,baseId:l,root:a,schemaPath:"",errSchemaPath:"#",errorPath:'""',MissingRefError:error_classes.MissingRef,RULES:p,validate,util,resolve:resolve_1,resolveRef:b,usePattern:F,useDefault:$,useCustomRule:w,opts:n,formats:m,logger:i.logger,self:i});y=vars(o,refValCode)+vars(f,patternCode)+vars(u,defaultCode)+vars(c,customRuleCode)+y,n.processCode&&(y=n.processCode(y));try{v=Function("self","RULES","formats","root","refVal","defaults","customRules","equal","ucs2length","ValidationError",y)(i,p,m,r,o,u,c,fastDeepEqual,ucs2length$1,ValidationError$1),o[0]=v}catch(e){throw i.logger.error("Error compiling schema, function code:",y),e}return v.schema=e,v.errors=null,v.refs=s,v.refVal=o,v.root=d?v:a,h&&(v.s=!0),!0===n.sourceCode&&(v.source={code:y,patterns:f,defaults:u}),v}function b(e,t,f){t=resolve_1.url(e,t);var l,u,d=s[t];if(void 0!==d)return P(l=o[d],u="refVal["+d+"]");if(!f&&r.refs){var c=r.refs[t];if(void 0!==c)return P(l=r.refVal[c],u=_(t,l))}u=_(t);var v=resolve_1.call(i,g,r,t);if(void 0===v){var h=a&&a[t];h&&(v=resolve_1.inlineRef(h,n.inlineRefs)?h:compile.call(i,h,r,a,e))}if(void 0!==v)return function(e,r){o[s[e]]=r}(t,v),P(v,u);!function(e){delete s[e]}(t)}function _(e,r){var a=o.length;return o[a]=r,s[e]=a,"refVal"+a}function P(e,r){return"object"==typeof e||"boolean"==typeof e?{code:r,schema:e,inline:!0}:{code:r,s:e&&!!e.s}}function F(e){var r=l[e];return void 0===r&&(r=l[e]=f.length,f[r]=e),"pattern"+r}function $(e){switch(typeof e){case"boolean":case"number":return""+e;case"string":return util.toQuotedString(e);case"object":if(null===e)return"null";var r=fastJsonStableStringify(e),a=d[r];return void 0===a&&(a=d[r]=u.length,u[a]=e),"default"+a}}function w(e,r,a,t){if(!1!==i._opts.validateSchema){var o=e.definition.dependencies;if(o&&!o.every((function(e){return Object.prototype.hasOwnProperty.call(a,e)})))throw Error("parent schema must have all required keywords: "+o.join(","));var s=e.definition.validateSchema;if(s)if(!s(r)){var f="keyword schema is invalid: "+i.errorsText(s.errors);if("log"!=i._opts.validateSchema)throw Error(f);i.logger.error(f)}}var l,u=e.definition.compile,d=e.definition.inline,v=e.definition.macro;if(u)l=u.call(i,r,a,t);else if(v)l=v.call(i,r,a,t),!1!==n.validateSchema&&i.validateSchema(l,!0);else if(d)l=d.call(i,t,e.keyword,r,a);else if(!(l=e.definition.validate))return;if(void 0===l)throw Error('custom keyword "'+e.keyword+'"failed to compile');var h=c.length;return c[h]=l,{code:"customRule"+h,validate:l}}}function checkCompiling(e,r,a){var t=compIndex.call(this,e,r,a);return t>=0?{index:t,compiling:!0}:(this._compilations[t=this._compilations.length]={schema:e,root:r,baseId:a},{index:t,compiling:!1})}function endCompiling(e,r,a){var t=compIndex.call(this,e,r,a);t>=0&&this._compilations.splice(t,1)}function compIndex(e,r,a){for(var t=0;t<this._compilations.length;t++){var i=this._compilations[t];if(i.schema==e&&i.root==r&&i.baseId==a)return t}return-1}function patternCode(e,r){return"var pattern"+e+" = new RegExp("+util.toQuotedString(r[e])+");"}function defaultCode(e){return"var default"+e+" = defaults["+e+"];"}function refValCode(e,r){return void 0===r[e]?"":"var refVal"+e+" = refVal["+e+"];"}function customRuleCode(e){return"var customRule"+e+" = customRules["+e+"];"}function vars(e,r){if(!e.length)return"";for(var a="",t=0;t<e.length;t++)a+=r(t,e);return a}var cache=createCommonjsModule((function(e){var r=e.exports=function(){this._cache={}};r.prototype.put=function(e,r){this._cache[e]=r},r.prototype.get=function(e){return this._cache[e]},r.prototype.del=function(e){delete this._cache[e]},r.prototype.clear=function(){this._cache={}}})),DATE=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,DAYS=[0,31,28,31,30,31,30,31,31,30,31,30,31],TIME=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i,HOSTNAME=/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,URI=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,URIREF=/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,URITEMPLATE=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,URL$1=/^(?:(?:http[s\u017F]?|ftp):\/\/)(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!10(?:\.[0-9]{1,3}){3})(?!127(?:\.[0-9]{1,3}){3})(?!169\.254(?:\.[0-9]{1,3}){2})(?!192\.168(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-?)*(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)(?:\.(?:(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-?)*(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)*(?:\.(?:(?:[KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]){2,})))(?::[0-9]{2,5})?(?:\/(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?$/i,UUID=/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,JSON_POINTER$1=/^(?:\/(?:[^~/]|~0|~1)*)*$/,JSON_POINTER_URI_FRAGMENT=/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,RELATIVE_JSON_POINTER$1=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,formats_1=formats;function formats(e){return util.copy(formats[e="full"==e?"full":"fast"])}function isLeapYear(e){return e%4==0&&(e%100!=0||e%400==0)}function date(e){var r=e.match(DATE);if(!r)return!1;var a=+r[2],t=+r[3];return a>=1&&a<=12&&t>=1&&t<=(2==a&&isLeapYear(+r[1])?29:DAYS[a])}function time(e,r){var a=e.match(TIME);if(!a)return!1;var t=a[1],i=a[2],n=a[3];return(t<=23&&i<=59&&n<=59||23==t&&59==i&&60==n)&&(!r||a[5])}formats.fast={date:/^\d\d\d\d-[0-1]\d-[0-3]\d$/,time:/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,"date-time":/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,uri:/^(?:[a-z][a-z0-9+-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,"uri-template":URITEMPLATE,url:URL$1,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,hostname:HOSTNAME,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex,uuid:UUID,"json-pointer":JSON_POINTER$1,"json-pointer-uri-fragment":JSON_POINTER_URI_FRAGMENT,"relative-json-pointer":RELATIVE_JSON_POINTER$1},formats.full={date,time,"date-time":date_time,uri,"uri-reference":URIREF,"uri-template":URITEMPLATE,url:URL$1,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:HOSTNAME,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex,uuid:UUID,"json-pointer":JSON_POINTER$1,"json-pointer-uri-fragment":JSON_POINTER_URI_FRAGMENT,"relative-json-pointer":RELATIVE_JSON_POINTER$1};var DATE_TIME_SEPARATOR=/t|\s/i;function date_time(e){var r=e.split(DATE_TIME_SEPARATOR);return 2==r.length&&date(r[0])&&time(r[1],!0)}var NOT_URI_FRAGMENT=/\/|:/;function uri(e){return NOT_URI_FRAGMENT.test(e)&&URI.test(e)}var Z_ANCHOR=/[^\\]\\Z/;function regex(e){if(Z_ANCHOR.test(e))return!1;try{return RegExp(e),!0}catch(e){return!1}}var ref=function(e,r,a){var t,i,n=" ",o=e.dataLevel,s=e.schema[r],f=e.errSchemaPath+"/"+r,l=!e.opts.allErrors,u="data"+(o||""),d="valid"+e.level;if("#"==s||"#/"==s)e.isRoot?(t=e.async,i="validate"):(t=!0===e.root.schema.s,i="root.refVal[0]");else{var c=e.resolveRef(e.baseId,s,e.isRoot);if(void 0===c){var v=e.MissingRefError.message(e.baseId,s);if("fail"==e.opts.missingRefs){e.logger.error(v),(y=y||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: '$ref' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(f)+" , params: { ref: '"+e.util.escapeQuotes(s)+"' } ",!1!==e.opts.messages&&(n+=" , message: 'can\\'t resolve reference "+e.util.escapeQuotes(s)+"' "),e.opts.verbose&&(n+=" , schema: "+e.util.toQuotedString(s)+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),n+=" } "):n+=" {} ";var h=n;n=y.pop(),n+=!e.compositeRule&&l?e.async?" throw new ValidationError(["+h+"]); ":" validate.errors = ["+h+"]; return false; ":" var err = "+h+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",l&&(n+=" if (false) { ")}else{if("ignore"!=e.opts.missingRefs)throw new e.MissingRefError(e.baseId,s,v);e.logger.warn(v),l&&(n+=" if (true) { ")}}else if(c.inline){var m=e.util.copy(e);m.level++;var p="valid"+m.level;m.schema=c.schema,m.schemaPath="",m.errSchemaPath=s,n+=" "+e.validate(m).replace(/validate\.schema/g,c.code)+" ",l&&(n+=" if ("+p+") { ")}else t=!0===c.s||e.async&&!1!==c.s,i=c.code}if(i){var y;(y=y||[]).push(n),n="",n+=e.opts.passContext?" "+i+".call(this, ":" "+i+"( ",n+=" "+u+", (dataPath || '')",'""'!=e.errorPath&&(n+=" + "+e.errorPath);var E=n+=" , "+(o?"data"+(o-1||""):"parentData")+" , "+(o?e.dataPathArr[o]:"parentDataProperty")+", rootData)  ";if(n=y.pop(),t){if(!e.async)throw Error("async schema referenced by sync schema");l&&(n+=" var "+d+"; "),n+=" try { await "+E+"; ",l&&(n+=" "+d+" = true; "),n+=" } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; ",l&&(n+=" "+d+" = false; "),n+=" } ",l&&(n+=" if ("+d+") { ")}else n+=" if (!"+E+") { if (vErrors === null) vErrors = "+i+".errors; else vErrors = vErrors.concat("+i+".errors); errors = vErrors.length; } ",l&&(n+=" else { ")}return n},allOf=function(e,r,a){var t=" ",i=e.schema[r],n=e.schemaPath+e.util.getProperty(r),o=e.errSchemaPath+"/"+r,s=!e.opts.allErrors,f=e.util.copy(e),l="";f.level++;var u="valid"+f.level,d=f.baseId,c=!0,v=i;if(v)for(var h,m=-1,p=v.length-1;m<p;)h=v[m+=1],(e.opts.strictKeywords?"object"==typeof h&&Object.keys(h).length>0:e.util.schemaHasRules(h,e.RULES.all))&&(c=!1,f.schema=h,f.schemaPath=n+"["+m+"]",f.errSchemaPath=o+"/"+m,t+="  "+e.validate(f)+" ",f.baseId=d,s&&(t+=" if ("+u+") { ",l+="}"));return s&&(t+=c?" if (true) { ":" "+l.slice(0,-1)+" "),t=e.util.cleanUpCode(t)},anyOf=function(e,r,a){var t=" ",i=e.level,n=e.dataLevel,o=e.schema[r],s=e.schemaPath+e.util.getProperty(r),f=e.errSchemaPath+"/"+r,l=!e.opts.allErrors,u="data"+(n||""),d="valid"+i,c="errs__"+i,v=e.util.copy(e),h="";v.level++;var m="valid"+v.level;if(o.every((function(r){return e.opts.strictKeywords?"object"==typeof r&&Object.keys(r).length>0:e.util.schemaHasRules(r,e.RULES.all)}))){var p=v.baseId;t+=" var "+c+" = errors; var "+d+" = false;  ";var y=e.compositeRule;e.compositeRule=v.compositeRule=!0;var E=o;if(E)for(var g,b=-1,_=E.length-1;b<_;)g=E[b+=1],v.schema=g,v.schemaPath=s+"["+b+"]",v.errSchemaPath=f+"/"+b,t+="  "+e.validate(v)+" ",v.baseId=p,t+=" "+d+" = "+d+" || "+m+"; if (!"+d+") { ",h+="}";e.compositeRule=v.compositeRule=y,t+=" "+h+" if (!"+d+") {   var err =   ",!1!==e.createErrors?(t+=" { keyword: 'anyOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(f)+" , params: {} ",!1!==e.opts.messages&&(t+=" , message: 'should match some schema in anyOf' "),e.opts.verbose&&(t+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&l&&(t+=e.async?" throw new ValidationError(vErrors); ":" validate.errors = vErrors; return false; "),t+=" } else {  errors = "+c+"; if (vErrors !== null) { if ("+c+") vErrors.length = "+c+"; else vErrors = null; } ",e.opts.allErrors&&(t+=" } "),t=e.util.cleanUpCode(t)}else l&&(t+=" if (true) { ");return t},comment=function(e,r,a){var t=" ",i=e.errSchemaPath+"/"+r,n=e.util.toQuotedString(e.schema[r]);return!0===e.opts.l?t+=" console.log("+n+");":"function"==typeof e.opts.l&&(t+=" self._opts.$comment("+n+", "+e.util.toQuotedString(i)+", validate.root.schema);"),t},_const=function(e,r,a){var t=" ",i=e.level,n=e.dataLevel,o=e.schema[r],s=e.schemaPath+e.util.getProperty(r),f=e.errSchemaPath+"/"+r,l=!e.opts.allErrors,u="data"+(n||""),d="valid"+i,c=e.opts.u&&o&&o.u;c&&(t+=" var schema"+i+" = "+e.util.getData(o.u,n,e.dataPathArr)+"; "),c||(t+=" var schema"+i+" = validate.schema"+s+";");var v=v||[];v.push(t+="var "+d+" = equal("+u+", schema"+i+"); if (!"+d+") {   "),t="",!1!==e.createErrors?(t+=" { keyword: 'const' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(f)+" , params: { allowedValue: schema"+i+" } ",!1!==e.opts.messages&&(t+=" , message: 'should be equal to constant' "),e.opts.verbose&&(t+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),t+=" } "):t+=" {} ";var h=t;return t=v.pop(),t+=!e.compositeRule&&l?e.async?" throw new ValidationError(["+h+"]); ":" validate.errors = ["+h+"]; return false; ":" var err = "+h+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" }",l&&(t+=" else { "),t},contains=function(e,r,a){var t=" ",i=e.level,n=e.dataLevel,o=e.schema[r],s=e.schemaPath+e.util.getProperty(r),f=e.errSchemaPath+"/"+r,l=!e.opts.allErrors,u="data"+(n||""),d="valid"+i,c="errs__"+i,v=e.util.copy(e);v.level++;var h="valid"+v.level,m="i"+i,p=v.dataLevel=e.dataLevel+1,y="data"+p,E=e.baseId,g=e.opts.strictKeywords?"object"==typeof o&&Object.keys(o).length>0:e.util.schemaHasRules(o,e.RULES.all);if(t+="var "+c+" = errors;var "+d+";",g){var b=e.compositeRule;e.compositeRule=v.compositeRule=!0,v.schema=o,v.schemaPath=s,v.errSchemaPath=f,t+=" var "+h+" = false; for (var "+m+" = 0; "+m+" < "+u+".length; "+m+"++) { ",v.errorPath=e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers,!0);var _=u+"["+m+"]";v.dataPathArr[p]=m;var P=e.validate(v);v.baseId=E,e.util.varOccurences(P,y)<2?t+=" "+e.util.varReplace(P,y,_)+" ":t+=" var "+y+" = "+_+"; "+P+" ",t+=" if ("+h+") break; }  ",e.compositeRule=v.compositeRule=b,t+="  if (!"+h+") {"}else t+=" if ("+u+".length == 0) {";var F=F||[];F.push(t),t="",!1!==e.createErrors?(t+=" { keyword: 'contains' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(f)+" , params: {} ",!1!==e.opts.messages&&(t+=" , message: 'should contain a valid item' "),e.opts.verbose&&(t+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),t+=" } "):t+=" {} ";var $=t;return t=F.pop(),t+=!e.compositeRule&&l?e.async?" throw new ValidationError(["+$+"]); ":" validate.errors = ["+$+"]; return false; ":" var err = "+$+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } else { ",g&&(t+="  errors = "+c+"; if (vErrors !== null) { if ("+c+") vErrors.length = "+c+"; else vErrors = null; } "),e.opts.allErrors&&(t+=" } "),t=e.util.cleanUpCode(t)},dependencies=function(e,r,a){var t=" ",i=e.level,n=e.dataLevel,o=e.schema[r],s=e.schemaPath+e.util.getProperty(r),f=e.errSchemaPath+"/"+r,l=!e.opts.allErrors,u="data"+(n||""),d="errs__"+i,c=e.util.copy(e),v="";c.level++;var h="valid"+c.level,m={},p={},y=e.opts.ownProperties;for(b in o){var E=Array.isArray(N=o[b])?p:m;E[b]=N}t+="var "+d+" = errors;";var g=e.errorPath;for(var b in t+="var missing"+i+";",p)if((E=p[b]).length){if(t+=" if ( "+u+e.util.getProperty(b)+" !== undefined ",y&&(t+=" && Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(b)+"') "),l){t+=" && ( ";var _=E;if(_)for(var P=-1,F=_.length-1;P<F;){S=_[P+=1],P&&(t+=" || "),t+=" ( ( "+(D=u+(T=e.util.getProperty(S)))+" === undefined ",y&&(t+=" || ! Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(S)+"') "),t+=") && (missing"+i+" = "+e.util.toQuotedString(e.opts.jsonPointers?S:T)+") ) "}t+=")) {  ";var $="missing"+i,w="' + "+$+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(g,$,!0):g+" + "+$);var O=O||[];O.push(t),t="",!1!==e.createErrors?(t+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(f)+" , params: { property: '"+e.util.escapeQuotes(b)+"', missingProperty: '"+w+"', depsCount: "+E.length+", deps: '"+e.util.escapeQuotes(1==E.length?E[0]:E.join(", "))+"' } ",!1!==e.opts.messages&&(t+=" , message: 'should have ",t+=1==E.length?"property "+e.util.escapeQuotes(E[0]):"properties "+e.util.escapeQuotes(E.join(", ")),t+=" when property "+e.util.escapeQuotes(b)+" is present' "),e.opts.verbose&&(t+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),t+=" } "):t+=" {} ";var A=t;t=O.pop(),t+=!e.compositeRule&&l?e.async?" throw new ValidationError(["+A+"]); ":" validate.errors = ["+A+"]; return false; ":" var err = "+A+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else{t+=" ) { ";var I=E;if(I)for(var S,R=-1,j=I.length-1;R<j;){S=I[R+=1];var T=e.util.getProperty(S),D=(w=e.util.escapeQuotes(S),u+T);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(g,S,e.opts.jsonPointers)),t+=" if ( "+D+" === undefined ",y&&(t+=" || ! Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(S)+"') "),t+=") {  var err =   ",!1!==e.createErrors?(t+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(f)+" , params: { property: '"+e.util.escapeQuotes(b)+"', missingProperty: '"+w+"', depsCount: "+E.length+", deps: '"+e.util.escapeQuotes(1==E.length?E[0]:E.join(", "))+"' } ",!1!==e.opts.messages&&(t+=" , message: 'should have ",t+=1==E.length?"property "+e.util.escapeQuotes(E[0]):"properties "+e.util.escapeQuotes(E.join(", ")),t+=" when property "+e.util.escapeQuotes(b)+" is present' "),e.opts.verbose&&(t+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}t+=" }   ",l&&(v+="}",t+=" else { ")}e.errorPath=g;var x=c.baseId;for(var b in m){var N=m[b];(e.opts.strictKeywords?"object"==typeof N&&Object.keys(N).length>0:e.util.schemaHasRules(N,e.RULES.all))&&(t+=" "+h+" = true; if ( "+u+e.util.getProperty(b)+" !== undefined ",y&&(t+=" && Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(b)+"') "),t+=") { ",c.schema=N,c.schemaPath=s+e.util.getProperty(b),c.errSchemaPath=f+"/"+e.util.escapeFragment(b),t+="  "+e.validate(c)+" ",c.baseId=x,t+=" }  ",l&&(t+=" if ("+h+") { ",v+="}"))}return l&&(t+="   "+v+" if ("+d+" == errors) {"),t=e.util.cleanUpCode(t)},_enum=function(e,r,a){var t=" ",i=e.level,n=e.dataLevel,o=e.schema[r],s=e.schemaPath+e.util.getProperty(r),f=e.errSchemaPath+"/"+r,l=!e.opts.allErrors,u="data"+(n||""),d="valid"+i,c=e.opts.u&&o&&o.u;c&&(t+=" var schema"+i+" = "+e.util.getData(o.u,n,e.dataPathArr)+"; ");var v="i"+i,h="schema"+i;c||(t+=" var "+h+" = validate.schema"+s+";"),t+="var "+d+";",c&&(t+=" if (schema"+i+" === undefined) "+d+" = true; else if (!Array.isArray(schema"+i+")) "+d+" = false; else {"),t+=d+" = false;for (var "+v+"=0; "+v+"<"+h+".length; "+v+"++) if (equal("+u+", "+h+"["+v+"])) { "+d+" = true; break; }",c&&(t+="  }  ");var m=m||[];m.push(t+=" if (!"+d+") {   "),t="",!1!==e.createErrors?(t+=" { keyword: 'enum' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(f)+" , params: { allowedValues: schema"+i+" } ",!1!==e.opts.messages&&(t+=" , message: 'should be equal to one of the allowed values' "),e.opts.verbose&&(t+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),t+=" } "):t+=" {} ";var p=t;return t=m.pop(),t+=!e.compositeRule&&l?e.async?" throw new ValidationError(["+p+"]); ":" validate.errors = ["+p+"]; return false; ":" var err = "+p+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" }",l&&(t+=" else { "),t},format=function(e,r,a){var t=" ",i=e.level,n=e.dataLevel,o=e.schema[r],s=e.schemaPath+e.util.getProperty(r),f=e.errSchemaPath+"/"+r,l=!e.opts.allErrors,u="data"+(n||"");if(!1===e.opts.format)return l&&(t+=" if (true) { "),t;var d,c=e.opts.u&&o&&o.u;c?(t+=" var schema"+i+" = "+e.util.getData(o.u,n,e.dataPathArr)+"; ",d="schema"+i):d=o;var v=e.opts.unknownFormats,h=Array.isArray(v);if(c){t+=" var "+(m="format"+i)+" = formats["+d+"]; var "+(p="isObject"+i)+" = typeof "+m+" == 'object' && !("+m+" instanceof RegExp) && "+m+".validate; var "+(y="formatType"+i)+" = "+p+" && "+m+".type || 'string'; if ("+p+") { ",e.async&&(t+=" var async"+i+" = "+m+".async; "),t+=" "+m+" = "+m+".validate; } if (  ",c&&(t+=" ("+d+" !== undefined && typeof "+d+" != 'string') || "),t+=" (","ignore"!=v&&(t+=" ("+d+" && !"+m+" ",h&&(t+=" && self._opts.unknownFormats.indexOf("+d+") == -1 "),t+=") || "),t+=" ("+m+" && "+y+" == '"+a+"' && !(typeof "+m+" == 'function' ? ",t+=e.async?" (async"+i+" ? await "+m+"("+u+") : "+m+"("+u+")) ":" "+m+"("+u+") ",t+=" : "+m+".test("+u+"))))) {"}else{var m;if(!(m=e.formats[o])){if("ignore"==v)return e.logger.warn('unknown format "'+o+'" ignored in schema at path "'+e.errSchemaPath+'"'),l&&(t+=" if (true) { "),t;if(h&&v.indexOf(o)>=0)return l&&(t+=" if (true) { "),t;throw Error('unknown format "'+o+'" is used in schema at path "'+e.errSchemaPath+'"')}var p,y=(p="object"==typeof m&&!(m instanceof RegExp)&&m.validate)&&m.type||"string";if(p){var E=!0===m.async;m=m.validate}if(y!=a)return l&&(t+=" if (true) { "),t;if(E){if(!e.async)throw Error("async format in sync schema");t+=" if (!(await "+(g="formats"+e.util.getProperty(o)+".validate")+"("+u+"))) { "}else{t+=" if (! ";var g="formats"+e.util.getProperty(o);p&&(g+=".validate"),t+="function"==typeof m?" "+g+"("+u+") ":" "+g+".test("+u+") ",t+=") { "}}var b=b||[];b.push(t),t="",!1!==e.createErrors?(t+=" { keyword: 'format' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(f)+" , params: { format:  ",t+=c?""+d:""+e.util.toQuotedString(o),t+="  } ",!1!==e.opts.messages&&(t+=" , message: 'should match format \"",t+=c?"' + "+d+" + '":""+e.util.escapeQuotes(o),t+="\"' "),e.opts.verbose&&(t+=" , schema:  ",t+=c?"validate.schema"+s:""+e.util.toQuotedString(o),t+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),t+=" } "):t+=" {} ";var _=t;return t=b.pop(),t+=!e.compositeRule&&l?e.async?" throw new ValidationError(["+_+"]); ":" validate.errors = ["+_+"]; return false; ":" var err = "+_+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } ",l&&(t+=" else { "),t},_if=function(e,r,a){var t=" ",i=e.level,n=e.dataLevel,o=e.schema[r],s=e.schemaPath+e.util.getProperty(r),f=e.errSchemaPath+"/"+r,l=!e.opts.allErrors,u="data"+(n||""),d="valid"+i,c="errs__"+i,v=e.util.copy(e);v.level++;var h="valid"+v.level,m=e.schema.then,p=e.schema.else,y=void 0!==m&&(e.opts.strictKeywords?"object"==typeof m&&Object.keys(m).length>0:e.util.schemaHasRules(m,e.RULES.all)),E=void 0!==p&&(e.opts.strictKeywords?"object"==typeof p&&Object.keys(p).length>0:e.util.schemaHasRules(p,e.RULES.all)),g=v.baseId;if(y||E){var b;v.createErrors=!1,v.schema=o,v.schemaPath=s,v.errSchemaPath=f,t+=" var "+c+" = errors; var "+d+" = true;  ";var _=e.compositeRule;e.compositeRule=v.compositeRule=!0,t+="  "+e.validate(v)+" ",v.baseId=g,v.createErrors=!0,t+="  errors = "+c+"; if (vErrors !== null) { if ("+c+") vErrors.length = "+c+"; else vErrors = null; }  ",e.compositeRule=v.compositeRule=_,y?(t+=" if ("+h+") {  ",v.schema=e.schema.then,v.schemaPath=e.schemaPath+".then",v.errSchemaPath=e.errSchemaPath+"/then",t+="  "+e.validate(v)+" ",v.baseId=g,t+=" "+d+" = "+h+"; ",y&&E?t+=" var "+(b="ifClause"+i)+" = 'then'; ":b="'then'",t+=" } ",E&&(t+=" else { ")):t+=" if (!"+h+") { ",E&&(v.schema=e.schema.else,v.schemaPath=e.schemaPath+".else",v.errSchemaPath=e.errSchemaPath+"/else",t+="  "+e.validate(v)+" ",v.baseId=g,t+=" "+d+" = "+h+"; ",y&&E?t+=" var "+(b="ifClause"+i)+" = 'else'; ":b="'else'",t+=" } "),t+=" if (!"+d+") {   var err =   ",!1!==e.createErrors?(t+=" { keyword: 'if' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(f)+" , params: { failingKeyword: "+b+" } ",!1!==e.opts.messages&&(t+=" , message: 'should match \"' + "+b+" + '\" schema' "),e.opts.verbose&&(t+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&l&&(t+=e.async?" throw new ValidationError(vErrors); ":" validate.errors = vErrors; return false; "),t+=" }   ",l&&(t+=" else { "),t=e.util.cleanUpCode(t)}else l&&(t+=" if (true) { ");return t},items=function(e,r,a){var t=" ",i=e.level,n=e.dataLevel,o=e.schema[r],s=e.schemaPath+e.util.getProperty(r),f=e.errSchemaPath+"/"+r,l=!e.opts.allErrors,u="data"+(n||""),d="valid"+i,c="errs__"+i,v=e.util.copy(e),h="";v.level++;var m="valid"+v.level,p="i"+i,y=v.dataLevel=e.dataLevel+1,E="data"+y,g=e.baseId;if(t+="var "+c+" = errors;var "+d+";",Array.isArray(o)){var b=e.schema.additionalItems;if(!1===b){t+=" "+d+" = "+u+".length <= "+o.length+"; ";var _=f;f=e.errSchemaPath+"/additionalItems";var P=P||[];P.push(t+="  if (!"+d+") {   "),t="",!1!==e.createErrors?(t+=" { keyword: 'additionalItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(f)+" , params: { limit: "+o.length+" } ",!1!==e.opts.messages&&(t+=" , message: 'should NOT have more than "+o.length+" items' "),e.opts.verbose&&(t+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),t+=" } "):t+=" {} ";var F=t;t=P.pop(),t+=!e.compositeRule&&l?e.async?" throw new ValidationError(["+F+"]); ":" validate.errors = ["+F+"]; return false; ":" var err = "+F+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } ",f=_,l&&(h+="}",t+=" else { ")}var $=o;if($)for(var w,O=-1,A=$.length-1;O<A;)if(w=$[O+=1],e.opts.strictKeywords?"object"==typeof w&&Object.keys(w).length>0:e.util.schemaHasRules(w,e.RULES.all)){t+=" "+m+" = true; if ("+u+".length > "+O+") { ";var I=u+"["+O+"]";v.schema=w,v.schemaPath=s+"["+O+"]",v.errSchemaPath=f+"/"+O,v.errorPath=e.util.getPathExpr(e.errorPath,O,e.opts.jsonPointers,!0),v.dataPathArr[y]=O;var S=e.validate(v);v.baseId=g,e.util.varOccurences(S,E)<2?t+=" "+e.util.varReplace(S,E,I)+" ":t+=" var "+E+" = "+I+"; "+S+" ",t+=" }  ",l&&(t+=" if ("+m+") { ",h+="}")}if("object"==typeof b&&(e.opts.strictKeywords?"object"==typeof b&&Object.keys(b).length>0:e.util.schemaHasRules(b,e.RULES.all))){v.schema=b,v.schemaPath=e.schemaPath+".additionalItems",v.errSchemaPath=e.errSchemaPath+"/additionalItems",t+=" "+m+" = true; if ("+u+".length > "+o.length+") {  for (var "+p+" = "+o.length+"; "+p+" < "+u+".length; "+p+"++) { ",v.errorPath=e.util.getPathExpr(e.errorPath,p,e.opts.jsonPointers,!0);I=u+"["+p+"]";v.dataPathArr[y]=p;S=e.validate(v);v.baseId=g,e.util.varOccurences(S,E)<2?t+=" "+e.util.varReplace(S,E,I)+" ":t+=" var "+E+" = "+I+"; "+S+" ",l&&(t+=" if (!"+m+") break; "),t+=" } }  ",l&&(t+=" if ("+m+") { ",h+="}")}}else if(e.opts.strictKeywords?"object"==typeof o&&Object.keys(o).length>0:e.util.schemaHasRules(o,e.RULES.all)){v.schema=o,v.schemaPath=s,v.errSchemaPath=f,t+="  for (var "+p+" = 0; "+p+" < "+u+".length; "+p+"++) { ",v.errorPath=e.util.getPathExpr(e.errorPath,p,e.opts.jsonPointers,!0);I=u+"["+p+"]";v.dataPathArr[y]=p;S=e.validate(v);v.baseId=g,e.util.varOccurences(S,E)<2?t+=" "+e.util.varReplace(S,E,I)+" ":t+=" var "+E+" = "+I+"; "+S+" ",l&&(t+=" if (!"+m+") break; "),t+=" }"}return l&&(t+=" "+h+" if ("+c+" == errors) {"),t=e.util.cleanUpCode(t)},_limit=function(e,r,a){var t,i=" ",n=e.level,o=e.dataLevel,s=e.schema[r],f=e.schemaPath+e.util.getProperty(r),l=e.errSchemaPath+"/"+r,u=!e.opts.allErrors,d="data"+(o||""),c=e.opts.u&&s&&s.u;c?(i+=" var schema"+n+" = "+e.util.getData(s.u,o,e.dataPathArr)+"; ",t="schema"+n):t=s;var v="maximum"==r,h=v?"exclusiveMaximum":"exclusiveMinimum",m=e.schema[h],p=e.opts.u&&m&&m.u,y=v?"<":">",E=v?">":"<",g=void 0;if(p){var b=e.util.getData(m.u,o,e.dataPathArr),_="exclusive"+n,P="exclType"+n,F="exclIsNumber"+n,$="' + "+(A="op"+n)+" + '";i+=" var schemaExcl"+n+" = "+b+"; ";var w;g=h;(w=w||[]).push(i+=" var "+_+"; var "+P+" = typeof "+(b="schemaExcl"+n)+"; if ("+P+" != 'boolean' && "+P+" != 'undefined' && "+P+" != 'number') { "),i="",!1!==e.createErrors?(i+=" { keyword: '"+(g||"_exclusiveLimit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: {} ",!1!==e.opts.messages&&(i+=" , message: '"+h+" should be boolean' "),e.opts.verbose&&(i+=" , schema: validate.schema"+f+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),i+=" } "):i+=" {} ";var O=i;i=w.pop(),i+=!e.compositeRule&&u?e.async?" throw new ValidationError(["+O+"]); ":" validate.errors = ["+O+"]; return false; ":" var err = "+O+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } else if ( ",c&&(i+=" ("+t+" !== undefined && typeof "+t+" != 'number') || "),i+=" "+P+" == 'number' ? ( ("+_+" = "+t+" === undefined || "+b+" "+y+"= "+t+") ? "+d+" "+E+"= "+b+" : "+d+" "+E+" "+t+" ) : ( ("+_+" = "+b+" === true) ? "+d+" "+E+"= "+t+" : "+d+" "+E+" "+t+" ) || "+d+" !== "+d+") { var op"+n+" = "+_+" ? '"+y+"' : '"+y+"='; ",void 0===s&&(g=h,l=e.errSchemaPath+"/"+h,t=b,c=p)}else{$=y;if((F="number"==typeof m)&&c){var A="'"+$+"'";i+=" if ( ",c&&(i+=" ("+t+" !== undefined && typeof "+t+" != 'number') || "),i+=" ( "+t+" === undefined || "+m+" "+y+"= "+t+" ? "+d+" "+E+"= "+m+" : "+d+" "+E+" "+t+" ) || "+d+" !== "+d+") { "}else{F&&void 0===s?(_=!0,g=h,l=e.errSchemaPath+"/"+h,t=m,E+="="):(F&&(t=Math[v?"min":"max"](m,s)),m===(!F||t)?(_=!0,g=h,l=e.errSchemaPath+"/"+h,E+="="):(_=!1,$+="="));A="'"+$+"'";i+=" if ( ",c&&(i+=" ("+t+" !== undefined && typeof "+t+" != 'number') || "),i+=" "+d+" "+E+" "+t+" || "+d+" !== "+d+") { "}}g=g||r,(w=w||[]).push(i),i="",!1!==e.createErrors?(i+=" { keyword: '"+(g||"_limit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { comparison: "+A+", limit: "+t+", exclusive: "+_+" } ",!1!==e.opts.messages&&(i+=" , message: 'should be "+$+" ",i+=c?"' + "+t:t+"'"),e.opts.verbose&&(i+=" , schema:  ",i+=c?"validate.schema"+f:""+s,i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),i+=" } "):i+=" {} ";O=i;return i=w.pop(),i+=!e.compositeRule&&u?e.async?" throw new ValidationError(["+O+"]); ":" validate.errors = ["+O+"]; return false; ":" var err = "+O+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } ",u&&(i+=" else { "),i},_limitItems=function(e,r,a){var t,i=" ",n=e.level,o=e.dataLevel,s=e.schema[r],f=e.schemaPath+e.util.getProperty(r),l=e.errSchemaPath+"/"+r,u=!e.opts.allErrors,d="data"+(o||""),c=e.opts.u&&s&&s.u;c?(i+=" var schema"+n+" = "+e.util.getData(s.u,o,e.dataPathArr)+"; ",t="schema"+n):t=s,i+="if ( ",c&&(i+=" ("+t+" !== undefined && typeof "+t+" != 'number') || ");var v=r,h=h||[];h.push(i+=" "+d+".length "+("maxItems"==r?">":"<")+" "+t+") { "),i="",!1!==e.createErrors?(i+=" { keyword: '"+(v||"_limitItems")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { limit: "+t+" } ",!1!==e.opts.messages&&(i+=" , message: 'should NOT have ",i+="maxItems"==r?"more":"fewer",i+=" than ",i+=c?"' + "+t+" + '":""+s,i+=" items' "),e.opts.verbose&&(i+=" , schema:  ",i+=c?"validate.schema"+f:""+s,i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),i+=" } "):i+=" {} ";var m=i;return i=h.pop(),i+=!e.compositeRule&&u?e.async?" throw new ValidationError(["+m+"]); ":" validate.errors = ["+m+"]; return false; ":" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+="} ",u&&(i+=" else { "),i},_limitLength=function(e,r,a){var t,i=" ",n=e.level,o=e.dataLevel,s=e.schema[r],f=e.schemaPath+e.util.getProperty(r),l=e.errSchemaPath+"/"+r,u=!e.opts.allErrors,d="data"+(o||""),c=e.opts.u&&s&&s.u;c?(i+=" var schema"+n+" = "+e.util.getData(s.u,o,e.dataPathArr)+"; ",t="schema"+n):t=s,i+="if ( ",c&&(i+=" ("+t+" !== undefined && typeof "+t+" != 'number') || "),i+=!1===e.opts.unicode?" "+d+".length ":" ucs2length("+d+") ";var v=r,h=h||[];h.push(i+=" "+("maxLength"==r?">":"<")+" "+t+") { "),i="",!1!==e.createErrors?(i+=" { keyword: '"+(v||"_limitLength")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { limit: "+t+" } ",!1!==e.opts.messages&&(i+=" , message: 'should NOT be ",i+="maxLength"==r?"longer":"shorter",i+=" than ",i+=c?"' + "+t+" + '":""+s,i+=" characters' "),e.opts.verbose&&(i+=" , schema:  ",i+=c?"validate.schema"+f:""+s,i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),i+=" } "):i+=" {} ";var m=i;return i=h.pop(),i+=!e.compositeRule&&u?e.async?" throw new ValidationError(["+m+"]); ":" validate.errors = ["+m+"]; return false; ":" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+="} ",u&&(i+=" else { "),i},_limitProperties=function(e,r,a){var t,i=" ",n=e.level,o=e.dataLevel,s=e.schema[r],f=e.schemaPath+e.util.getProperty(r),l=e.errSchemaPath+"/"+r,u=!e.opts.allErrors,d="data"+(o||""),c=e.opts.u&&s&&s.u;c?(i+=" var schema"+n+" = "+e.util.getData(s.u,o,e.dataPathArr)+"; ",t="schema"+n):t=s,i+="if ( ",c&&(i+=" ("+t+" !== undefined && typeof "+t+" != 'number') || ");var v=r,h=h||[];h.push(i+=" Object.keys("+d+").length "+("maxProperties"==r?">":"<")+" "+t+") { "),i="",!1!==e.createErrors?(i+=" { keyword: '"+(v||"_limitProperties")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { limit: "+t+" } ",!1!==e.opts.messages&&(i+=" , message: 'should NOT have ",i+="maxProperties"==r?"more":"fewer",i+=" than ",i+=c?"' + "+t+" + '":""+s,i+=" properties' "),e.opts.verbose&&(i+=" , schema:  ",i+=c?"validate.schema"+f:""+s,i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),i+=" } "):i+=" {} ";var m=i;return i=h.pop(),i+=!e.compositeRule&&u?e.async?" throw new ValidationError(["+m+"]); ":" validate.errors = ["+m+"]; return false; ":" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+="} ",u&&(i+=" else { "),i},multipleOf=function(e,r,a){var t,i=" ",n=e.level,o=e.dataLevel,s=e.schema[r],f=e.schemaPath+e.util.getProperty(r),l=e.errSchemaPath+"/"+r,u=!e.opts.allErrors,d="data"+(o||""),c=e.opts.u&&s&&s.u;c?(i+=" var schema"+n+" = "+e.util.getData(s.u,o,e.dataPathArr)+"; ",t="schema"+n):t=s,i+="var division"+n+";if (",c&&(i+=" "+t+" !== undefined && ( typeof "+t+" != 'number' || "),i+=" (division"+n+" = "+d+" / "+t+", ",i+=e.opts.multipleOfPrecision?" Math.abs(Math.round(division"+n+") - division"+n+") > 1e-"+e.opts.multipleOfPrecision+" ":" division"+n+" !== parseInt(division"+n+") ",i+=" ) ",c&&(i+="  )  ");var v=v||[];v.push(i+=" ) {   "),i="",!1!==e.createErrors?(i+=" { keyword: 'multipleOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { multipleOf: "+t+" } ",!1!==e.opts.messages&&(i+=" , message: 'should be multiple of ",i+=c?"' + "+t:t+"'"),e.opts.verbose&&(i+=" , schema:  ",i+=c?"validate.schema"+f:""+s,i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),i+=" } "):i+=" {} ";var h=i;return i=v.pop(),i+=!e.compositeRule&&u?e.async?" throw new ValidationError(["+h+"]); ":" validate.errors = ["+h+"]; return false; ":" var err = "+h+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+="} ",u&&(i+=" else { "),i},not=function(e,r,a){var t=" ",i=e.level,n=e.dataLevel,o=e.schema[r],s=e.schemaPath+e.util.getProperty(r),f=e.errSchemaPath+"/"+r,l=!e.opts.allErrors,u="data"+(n||""),d="errs__"+i,c=e.util.copy(e);c.level++;var v="valid"+c.level;if(e.opts.strictKeywords?"object"==typeof o&&Object.keys(o).length>0:e.util.schemaHasRules(o,e.RULES.all)){c.schema=o,c.schemaPath=s,c.errSchemaPath=f,t+=" var "+d+" = errors;  ";var h,m=e.compositeRule;e.compositeRule=c.compositeRule=!0,c.createErrors=!1,c.opts.allErrors&&(h=c.opts.allErrors,c.opts.allErrors=!1),t+=" "+e.validate(c)+" ",c.createErrors=!0,h&&(c.opts.allErrors=h),e.compositeRule=c.compositeRule=m;var p=p||[];p.push(t+=" if ("+v+") {   "),t="",!1!==e.createErrors?(t+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(f)+" , params: {} ",!1!==e.opts.messages&&(t+=" , message: 'should NOT be valid' "),e.opts.verbose&&(t+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),t+=" } "):t+=" {} ";var y=t;t=p.pop(),t+=!e.compositeRule&&l?e.async?" throw new ValidationError(["+y+"]); ":" validate.errors = ["+y+"]; return false; ":" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } else {  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; } ",e.opts.allErrors&&(t+=" } ")}else t+="  var err =   ",!1!==e.createErrors?(t+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(f)+" , params: {} ",!1!==e.opts.messages&&(t+=" , message: 'should NOT be valid' "),e.opts.verbose&&(t+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",l&&(t+=" if (false) { ");return t},oneOf=function(e,r,a){var t=" ",i=e.level,n=e.dataLevel,o=e.schema[r],s=e.schemaPath+e.util.getProperty(r),f=e.errSchemaPath+"/"+r,l=!e.opts.allErrors,u="data"+(n||""),d="valid"+i,c="errs__"+i,v=e.util.copy(e),h="";v.level++;var m="valid"+v.level,p=v.baseId,y="prevValid"+i,E="passingSchemas"+i;t+="var "+c+" = errors , "+y+" = false , "+d+" = false , "+E+" = null; ";var g=e.compositeRule;e.compositeRule=v.compositeRule=!0;var b=o;if(b)for(var _,P=-1,F=b.length-1;P<F;)_=b[P+=1],(e.opts.strictKeywords?"object"==typeof _&&Object.keys(_).length>0:e.util.schemaHasRules(_,e.RULES.all))?(v.schema=_,v.schemaPath=s+"["+P+"]",v.errSchemaPath=f+"/"+P,t+="  "+e.validate(v)+" ",v.baseId=p):t+=" var "+m+" = true; ",P&&(t+=" if ("+m+" && "+y+") { "+d+" = false; "+E+" = ["+E+", "+P+"]; } else { ",h+="}"),t+=" if ("+m+") { "+d+" = "+y+" = true; "+E+" = "+P+"; }";return e.compositeRule=v.compositeRule=g,t+=h+"if (!"+d+") {   var err =   ",!1!==e.createErrors?(t+=" { keyword: 'oneOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(f)+" , params: { passingSchemas: "+E+" } ",!1!==e.opts.messages&&(t+=" , message: 'should match exactly one schema in oneOf' "),e.opts.verbose&&(t+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&l&&(t+=e.async?" throw new ValidationError(vErrors); ":" validate.errors = vErrors; return false; "),t+="} else {  errors = "+c+"; if (vErrors !== null) { if ("+c+") vErrors.length = "+c+"; else vErrors = null; }",e.opts.allErrors&&(t+=" } "),t},pattern=function(e,r,a){var t,i=" ",n=e.level,o=e.dataLevel,s=e.schema[r],f=e.schemaPath+e.util.getProperty(r),l=e.errSchemaPath+"/"+r,u=!e.opts.allErrors,d="data"+(o||""),c=e.opts.u&&s&&s.u;c?(i+=" var schema"+n+" = "+e.util.getData(s.u,o,e.dataPathArr)+"; ",t="schema"+n):t=s;var v=c?"(new RegExp("+t+"))":e.usePattern(s);i+="if ( ",c&&(i+=" ("+t+" !== undefined && typeof "+t+" != 'string') || ");var h=h||[];h.push(i+=" !"+v+".test("+d+") ) {   "),i="",!1!==e.createErrors?(i+=" { keyword: 'pattern' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { pattern:  ",i+=c?""+t:""+e.util.toQuotedString(s),i+="  } ",!1!==e.opts.messages&&(i+=" , message: 'should match pattern \"",i+=c?"' + "+t+" + '":""+e.util.escapeQuotes(s),i+="\"' "),e.opts.verbose&&(i+=" , schema:  ",i+=c?"validate.schema"+f:""+e.util.toQuotedString(s),i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),i+=" } "):i+=" {} ";var m=i;return i=h.pop(),i+=!e.compositeRule&&u?e.async?" throw new ValidationError(["+m+"]); ":" validate.errors = ["+m+"]; return false; ":" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+="} ",u&&(i+=" else { "),i},properties=function(e,r,a){var t=" ",i=e.level,n=e.dataLevel,o=e.schema[r],s=e.schemaPath+e.util.getProperty(r),f=e.errSchemaPath+"/"+r,l=!e.opts.allErrors,u="data"+(n||""),d="errs__"+i,c=e.util.copy(e),v="";c.level++;var h="valid"+c.level,m="key"+i,p="idx"+i,y=c.dataLevel=e.dataLevel+1,E="data"+y,g="dataProperties"+i,b=Object.keys(o||{}),_=e.schema.patternProperties||{},P=Object.keys(_),F=e.schema.additionalProperties,$=b.length||P.length,w=!1===F,O="object"==typeof F&&Object.keys(F).length,A=e.opts.removeAdditional,I=w||O||A,S=e.opts.ownProperties,R=e.baseId,j=e.schema.required;if(j&&(!e.opts.u||!j.u)&&j.length<e.opts.loopRequired)var T=e.util.toHash(j);if(t+="var "+d+" = errors;var "+h+" = true;",S&&(t+=" var "+g+" = undefined;"),I){if(t+=S?" "+g+" = "+g+" || Object.keys("+u+"); for (var "+p+"=0; "+p+"<"+g+".length; "+p+"++) { var "+m+" = "+g+"["+p+"]; ":" for (var "+m+" in "+u+") { ",$){if(t+=" var isAdditional"+i+" = !(false ",b.length)if(b.length>8)t+=" || validate.schema"+s+".hasOwnProperty("+m+") ";else{var D=b;if(D)for(var x=-1,N=D.length-1;x<N;)Y=D[x+=1],t+=" || "+m+" == "+e.util.toQuotedString(Y)+" "}if(P.length){var k=P;if(k)for(var C=-1,z=k.length-1;C<z;)ie=k[C+=1],t+=" || "+e.usePattern(ie)+".test("+m+") "}t+=" ); if (isAdditional"+i+") { "}if("all"==A)t+=" delete "+u+"["+m+"]; ";else{var M=e.errorPath,V="' + "+m+" + '";if(e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers)),w)if(A)t+=" delete "+u+"["+m+"]; ";else{var U=f;f=e.errSchemaPath+"/additionalProperties",(re=re||[]).push(t+=" "+h+" = false; "),t="",!1!==e.createErrors?(t+=" { keyword: 'additionalProperties' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(f)+" , params: { additionalProperty: '"+V+"' } ",!1!==e.opts.messages&&(t+=" , message: '",t+=e.opts._errorDataPathProperty?"is an invalid additional property":"should NOT have additional properties",t+="' "),e.opts.verbose&&(t+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),t+=" } "):t+=" {} ";var q=t;t=re.pop(),t+=!e.compositeRule&&l?e.async?" throw new ValidationError(["+q+"]); ":" validate.errors = ["+q+"]; return false; ":" var err = "+q+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",f=U,l&&(t+=" break; ")}else if(O)if("failing"==A){t+=" var "+d+" = errors;  ";var L=e.compositeRule;e.compositeRule=c.compositeRule=!0,c.schema=F,c.schemaPath=e.schemaPath+".additionalProperties",c.errSchemaPath=e.errSchemaPath+"/additionalProperties",c.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers);var H=u+"["+m+"]";c.dataPathArr[y]=m;var J=e.validate(c);c.baseId=R,e.util.varOccurences(J,E)<2?t+=" "+e.util.varReplace(J,E,H)+" ":t+=" var "+E+" = "+H+"; "+J+" ",t+=" if (!"+h+") { errors = "+d+"; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete "+u+"["+m+"]; }  ",e.compositeRule=c.compositeRule=L}else{c.schema=F,c.schemaPath=e.schemaPath+".additionalProperties",c.errSchemaPath=e.errSchemaPath+"/additionalProperties",c.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers);H=u+"["+m+"]";c.dataPathArr[y]=m;J=e.validate(c);c.baseId=R,e.util.varOccurences(J,E)<2?t+=" "+e.util.varReplace(J,E,H)+" ":t+=" var "+E+" = "+H+"; "+J+" ",l&&(t+=" if (!"+h+") break; ")}e.errorPath=M}$&&(t+=" } "),t+=" }  ",l&&(t+=" if ("+h+") { ",v+="}")}var K=e.opts.useDefaults&&!e.compositeRule;if(b.length){var G=b;if(G)for(var Y,B=-1,Z=G.length-1;B<Z;){var Q=o[Y=G[B+=1]];if(e.opts.strictKeywords?"object"==typeof Q&&Object.keys(Q).length>0:e.util.schemaHasRules(Q,e.RULES.all)){var X=e.util.getProperty(Y),W=(H=u+X,K&&void 0!==Q.default);c.schema=Q,c.schemaPath=s+X,c.errSchemaPath=f+"/"+e.util.escapeFragment(Y),c.errorPath=e.util.getPath(e.errorPath,Y,e.opts.jsonPointers),c.dataPathArr[y]=e.util.toQuotedString(Y);J=e.validate(c);if(c.baseId=R,e.util.varOccurences(J,E)<2){J=e.util.varReplace(J,E,H);var ee=H}else{ee=E;t+=" var "+E+" = "+H+"; "}if(W)t+=" "+J+" ";else{if(T&&T[Y]){t+=" if ( "+ee+" === undefined ",S&&(t+=" || ! Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(Y)+"') "),t+=") { "+h+" = false; ";M=e.errorPath,U=f;var re,ae=e.util.escapeQuotes(Y);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(M,Y,e.opts.jsonPointers)),f=e.errSchemaPath+"/required",(re=re||[]).push(t),t="",!1!==e.createErrors?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(f)+" , params: { missingProperty: '"+ae+"' } ",!1!==e.opts.messages&&(t+=" , message: '",t+=e.opts._errorDataPathProperty?"is a required property":"should have required property \\'"+ae+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),t+=" } "):t+=" {} ";q=t;t=re.pop(),t+=!e.compositeRule&&l?e.async?" throw new ValidationError(["+q+"]); ":" validate.errors = ["+q+"]; return false; ":" var err = "+q+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",f=U,e.errorPath=M,t+=" } else { "}else l?(t+=" if ( "+ee+" === undefined ",S&&(t+=" || ! Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(Y)+"') "),t+=") { "+h+" = true; } else { "):(t+=" if ("+ee+" !== undefined ",S&&(t+=" &&   Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(Y)+"') "),t+=" ) { ");t+=" "+J+" } "}}l&&(t+=" if ("+h+") { ",v+="}")}}if(P.length){var te=P;if(te)for(var ie,ne=-1,oe=te.length-1;ne<oe;){Q=_[ie=te[ne+=1]];if(e.opts.strictKeywords?"object"==typeof Q&&Object.keys(Q).length>0:e.util.schemaHasRules(Q,e.RULES.all)){c.schema=Q,c.schemaPath=e.schemaPath+".patternProperties"+e.util.getProperty(ie),c.errSchemaPath=e.errSchemaPath+"/patternProperties/"+e.util.escapeFragment(ie),t+=S?" "+g+" = "+g+" || Object.keys("+u+"); for (var "+p+"=0; "+p+"<"+g+".length; "+p+"++) { var "+m+" = "+g+"["+p+"]; ":" for (var "+m+" in "+u+") { ",t+=" if ("+e.usePattern(ie)+".test("+m+")) { ",c.errorPath=e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers);H=u+"["+m+"]";c.dataPathArr[y]=m;J=e.validate(c);c.baseId=R,e.util.varOccurences(J,E)<2?t+=" "+e.util.varReplace(J,E,H)+" ":t+=" var "+E+" = "+H+"; "+J+" ",l&&(t+=" if (!"+h+") break; "),t+=" } ",l&&(t+=" else "+h+" = true; "),t+=" }  ",l&&(t+=" if ("+h+") { ",v+="}")}}}return l&&(t+=" "+v+" if ("+d+" == errors) {"),t=e.util.cleanUpCode(t)},propertyNames=function(e,r,a){var t=" ",i=e.level,n=e.dataLevel,o=e.schema[r],s=e.schemaPath+e.util.getProperty(r),f=e.errSchemaPath+"/"+r,l=!e.opts.allErrors,u="data"+(n||""),d="errs__"+i,c=e.util.copy(e);c.level++;var v="valid"+c.level;if(t+="var "+d+" = errors;",e.opts.strictKeywords?"object"==typeof o&&Object.keys(o).length>0:e.util.schemaHasRules(o,e.RULES.all)){c.schema=o,c.schemaPath=s,c.errSchemaPath=f;var h="key"+i,m="idx"+i,p="i"+i,y="' + "+h+" + '",E="data"+(c.dataLevel=e.dataLevel+1),g="dataProperties"+i,b=e.opts.ownProperties,_=e.baseId;b&&(t+=" var "+g+" = undefined; "),t+=b?" "+g+" = "+g+" || Object.keys("+u+"); for (var "+m+"=0; "+m+"<"+g+".length; "+m+"++) { var "+h+" = "+g+"["+m+"]; ":" for (var "+h+" in "+u+") { ",t+=" var startErrs"+i+" = errors; ";var P=h,F=e.compositeRule;e.compositeRule=c.compositeRule=!0;var $=e.validate(c);c.baseId=_,e.util.varOccurences($,E)<2?t+=" "+e.util.varReplace($,E,P)+" ":t+=" var "+E+" = "+P+"; "+$+" ",e.compositeRule=c.compositeRule=F,t+=" if (!"+v+") { for (var "+p+"=startErrs"+i+"; "+p+"<errors; "+p+"++) { vErrors["+p+"].propertyName = "+h+"; }   var err =   ",!1!==e.createErrors?(t+=" { keyword: 'propertyNames' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(f)+" , params: { propertyName: '"+y+"' } ",!1!==e.opts.messages&&(t+=" , message: 'property name \\'"+y+"\\' is invalid' "),e.opts.verbose&&(t+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&l&&(t+=e.async?" throw new ValidationError(vErrors); ":" validate.errors = vErrors; return false; "),l&&(t+=" break; "),t+=" } }"}return l&&(t+="  if ("+d+" == errors) {"),t=e.util.cleanUpCode(t)},required=function(e,r,a){var t=" ",i=e.level,n=e.dataLevel,o=e.schema[r],s=e.schemaPath+e.util.getProperty(r),f=e.errSchemaPath+"/"+r,l=!e.opts.allErrors,u="data"+(n||""),d="valid"+i,c=e.opts.u&&o&&o.u;c&&(t+=" var schema"+i+" = "+e.util.getData(o.u,n,e.dataPathArr)+"; ");var v="schema"+i;if(!c)if(o.length<e.opts.loopRequired&&e.schema.properties&&Object.keys(e.schema.properties).length){var h=[],m=o;if(m)for(var p,y=-1,E=m.length-1;y<E;){p=m[y+=1];var g=e.schema.properties[p];g&&(e.opts.strictKeywords?"object"==typeof g&&Object.keys(g).length>0:e.util.schemaHasRules(g,e.RULES.all))||(h[h.length]=p)}}else h=o;if(c||h.length){var b=e.errorPath,_=c||h.length>=e.opts.loopRequired,P=e.opts.ownProperties;if(l)if(t+=" var missing"+i+"; ",_){c||(t+=" var "+v+" = validate.schema"+s+"; ");var F="' + "+(S="schema"+i+"["+(O="i"+i)+"]")+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(b,S,e.opts.jsonPointers)),t+=" var "+d+" = true; ",c&&(t+=" if (schema"+i+" === undefined) "+d+" = true; else if (!Array.isArray(schema"+i+")) "+d+" = false; else {"),t+=" for (var "+O+" = 0; "+O+" < "+v+".length; "+O+"++) { "+d+" = "+u+"["+v+"["+O+"]] !== undefined ",P&&(t+=" &&   Object.prototype.hasOwnProperty.call("+u+", "+v+"["+O+"]) "),t+="; if (!"+d+") break; } ",c&&(t+="  }  "),(I=I||[]).push(t+="  if (!"+d+") {   "),t="",!1!==e.createErrors?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(f)+" , params: { missingProperty: '"+F+"' } ",!1!==e.opts.messages&&(t+=" , message: '",t+=e.opts._errorDataPathProperty?"is a required property":"should have required property \\'"+F+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),t+=" } "):t+=" {} ";var $=t;t=I.pop(),t+=!e.compositeRule&&l?e.async?" throw new ValidationError(["+$+"]); ":" validate.errors = ["+$+"]; return false; ":" var err = "+$+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } else { "}else{t+=" if ( ";var w=h;if(w)for(var O=-1,A=w.length-1;O<A;){j=w[O+=1],O&&(t+=" || "),t+=" ( ( "+(N=u+(x=e.util.getProperty(j)))+" === undefined ",P&&(t+=" || ! Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(j)+"') "),t+=") && (missing"+i+" = "+e.util.toQuotedString(e.opts.jsonPointers?j:x)+") ) "}t+=") {  ";var I;F="' + "+(S="missing"+i)+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(b,S,!0):b+" + "+S),(I=I||[]).push(t),t="",!1!==e.createErrors?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(f)+" , params: { missingProperty: '"+F+"' } ",!1!==e.opts.messages&&(t+=" , message: '",t+=e.opts._errorDataPathProperty?"is a required property":"should have required property \\'"+F+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),t+=" } "):t+=" {} ";$=t;t=I.pop(),t+=!e.compositeRule&&l?e.async?" throw new ValidationError(["+$+"]); ":" validate.errors = ["+$+"]; return false; ":" var err = "+$+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",t+=" } else { "}else if(_){c||(t+=" var "+v+" = validate.schema"+s+"; ");var S;F="' + "+(S="schema"+i+"["+(O="i"+i)+"]")+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(b,S,e.opts.jsonPointers)),c&&(t+=" if ("+v+" && !Array.isArray("+v+")) {  var err =   ",!1!==e.createErrors?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(f)+" , params: { missingProperty: '"+F+"' } ",!1!==e.opts.messages&&(t+=" , message: '",t+=e.opts._errorDataPathProperty?"is a required property":"should have required property \\'"+F+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else if ("+v+" !== undefined) { "),t+=" for (var "+O+" = 0; "+O+" < "+v+".length; "+O+"++) { if ("+u+"["+v+"["+O+"]] === undefined ",P&&(t+=" || ! Object.prototype.hasOwnProperty.call("+u+", "+v+"["+O+"]) "),t+=") {  var err =   ",!1!==e.createErrors?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(f)+" , params: { missingProperty: '"+F+"' } ",!1!==e.opts.messages&&(t+=" , message: '",t+=e.opts._errorDataPathProperty?"is a required property":"should have required property \\'"+F+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } } ",c&&(t+="  }  ")}else{var R=h;if(R)for(var j,T=-1,D=R.length-1;T<D;){j=R[T+=1];var x=e.util.getProperty(j),N=(F=e.util.escapeQuotes(j),u+x);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(b,j,e.opts.jsonPointers)),t+=" if ( "+N+" === undefined ",P&&(t+=" || ! Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(j)+"') "),t+=") {  var err =   ",!1!==e.createErrors?(t+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(f)+" , params: { missingProperty: '"+F+"' } ",!1!==e.opts.messages&&(t+=" , message: '",t+=e.opts._errorDataPathProperty?"is a required property":"should have required property \\'"+F+"\\'",t+="' "),e.opts.verbose&&(t+=" , schema: validate.schema"+s+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),t+=" } "):t+=" {} ",t+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}e.errorPath=b}else l&&(t+=" if (true) {");return t},uniqueItems=function(e,r,a){var t,i=" ",n=e.level,o=e.dataLevel,s=e.schema[r],f=e.schemaPath+e.util.getProperty(r),l=e.errSchemaPath+"/"+r,u=!e.opts.allErrors,d="data"+(o||""),c="valid"+n,v=e.opts.u&&s&&s.u;if(v?(i+=" var schema"+n+" = "+e.util.getData(s.u,o,e.dataPathArr)+"; ",t="schema"+n):t=s,(s||v)&&!1!==e.opts.uniqueItems){v&&(i+=" var "+c+"; if ("+t+" === false || "+t+" === undefined) "+c+" = true; else if (typeof "+t+" != 'boolean') "+c+" = false; else { "),i+=" var i = "+d+".length , "+c+" = true , j; if (i > 1) { ";var h=e.schema.items&&e.schema.items.type,m=Array.isArray(h);if(!h||"object"==h||"array"==h||m&&(h.indexOf("object")>=0||h.indexOf("array")>=0))i+=" outer: for (;i--;) { for (j = i; j--;) { if (equal("+d+"[i], "+d+"[j])) { "+c+" = false; break outer; } } } ";else i+=" var itemIndices = {}, item; for (;i--;) { var item = "+d+"[i]; ",i+=" if ("+e.util["checkDataType"+(m?"s":"")](h,"item",!0)+") continue; ",m&&(i+=" if (typeof item == 'string') item = '\"' + item; "),i+=" if (typeof itemIndices[item] == 'number') { "+c+" = false; j = itemIndices[item]; break; } itemIndices[item] = i; } ";i+=" } ",v&&(i+="  }  ");var p=p||[];p.push(i+=" if (!"+c+") {   "),i="",!1!==e.createErrors?(i+=" { keyword: 'uniqueItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { i: i, j: j } ",!1!==e.opts.messages&&(i+=" , message: 'should NOT have duplicate items (items ## ' + j + ' and ' + i + ' are identical)' "),e.opts.verbose&&(i+=" , schema:  ",i+=v?"validate.schema"+f:""+s,i+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),i+=" } "):i+=" {} ";var y=i;i=p.pop(),i+=!e.compositeRule&&u?e.async?" throw new ValidationError(["+y+"]); ":" validate.errors = ["+y+"]; return false; ":" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } ",u&&(i+=" else { ")}else u&&(i+=" if (true) { ");return i},dotjs={o:ref,allOf,anyOf,l:comment,const:_const,contains,dependencies,enum:_enum,format,if:_if,items,maximum:_limit,minimum:_limit,maxItems:_limitItems,minItems:_limitItems,maxLength:_limitLength,minLength:_limitLength,maxProperties:_limitProperties,minProperties:_limitProperties,multipleOf,not,oneOf,pattern,properties,propertyNames,required,uniqueItems,validate},toHash$1=util.toHash,rules=function(){var e=[{type:"number",rules:[{maximum:["exclusiveMaximum"]},{minimum:["exclusiveMinimum"]},"multipleOf","format"]},{type:"string",rules:["maxLength","minLength","pattern","format"]},{type:"array",rules:["maxItems","minItems","items","contains","uniqueItems"]},{type:"object",rules:["maxProperties","minProperties","required","dependencies","propertyNames",{properties:["additionalProperties","patternProperties"]}]},{rules:["$ref","const","enum","not","anyOf","oneOf","allOf","if"]}],r=["type","$comment"];return e.all=toHash$1(r),e.types=toHash$1(["number","integer","string","array","object","boolean","null"]),e.forEach((function(a){a.rules=a.rules.map((function(a){var t;if("object"==typeof a){var i=Object.keys(a)[0];t=a[i],a=i,t.forEach((function(a){r.push(a),e.all[a]=!0}))}return r.push(a),e.all[a]={keyword:a,code:dotjs[a],implements:t}})),e.all.l={keyword:"$comment",code:dotjs.l},a.type&&(e.types[a.type]=a)})),e.keywords=toHash$1(r.concat(["$schema","$id","id","$data","$async","title","description","default","definitions","examples","readOnly","writeOnly","contentMediaType","contentEncoding","additionalItems","then","else"])),e.custom={},e},KEYWORDS=["multipleOf","maximum","exclusiveMaximum","minimum","exclusiveMinimum","maxLength","minLength","pattern","additionalItems","maxItems","minItems","uniqueItems","maxProperties","minProperties","required","additionalProperties","enum","format","const"],data=function(e,r){for(var a=0;a<r.length;a++){e=JSON.parse(JSON.stringify(e));var t,i=r[a].split("/"),n=e;for(t=1;t<i.length;t++)n=n[i[t]];for(t=0;t<KEYWORDS.length;t++){var o=KEYWORDS[t],s=n[o];s&&(n[o]={anyOf:[s,{o:"https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/data.json#"}]})}}return e},MissingRefError$1=error_classes.MissingRef,async=compileAsync;function compileAsync(e,r,a){var t=this;if("function"!=typeof this._opts.loadSchema)throw Error("options.loadSchema should be a function");"function"==typeof r&&(a=r,r=void 0);var i=n(e).then((function(){var a=t._addSchema(e,void 0,r);return a.validate||function e(a){try{return t._compile(a)}catch(e){if(e instanceof MissingRefError$1)return i(e);throw e}function i(i){var o=i.missingSchema;if(l(o))throw Error("Schema "+o+" is loaded but "+i.missingRef+" cannot be resolved");var s=t._loadingSchemas[o];return s||(s=t._loadingSchemas[o]=t._opts.loadSchema(o)).then(f,f),s.then((function(e){if(!l(o))return n(e).then((function(){l(o)||t.addSchema(e,o,void 0,r)}))})).then((function(){return e(a)}));function f(){delete t._loadingSchemas[o]}function l(e){return t._refs[e]||t._schemas[e]}}}(a)}));return a&&i.then((function(e){a(null,e)}),a),i;function n(e){var r=e.v;return r&&!t.getSchema(r)?compileAsync.call(t,{o:r},!0):Promise.resolve()}}var custom=function(e,r,a){var t,i,n=" ",o=e.level,s=e.dataLevel,f=e.schema[r],l=e.schemaPath+e.util.getProperty(r),u=e.errSchemaPath+"/"+r,d=!e.opts.allErrors,c="data"+(s||""),v="valid"+o,h="errs__"+o,m=e.opts.u&&f&&f.u;m?(n+=" var schema"+o+" = "+e.util.getData(f.u,s,e.dataPathArr)+"; ",i="schema"+o):i=f;var p,y,E,g,b,_="definition"+o,P=this.definition,F="";if(m&&P.u){var $=P.validateSchema;n+=" var "+_+" = RULES.custom['"+r+"'].definition; var "+(b="keywordValidate"+o)+" = "+_+".validate;"}else{if(!(g=e.useCustomRule(this,f,e.schema,e)))return;i="validate.schema"+l,b=g.code,p=P.compile,y=P.inline,E=P.macro}var w=b+".errors",O="i"+o,A="ruleErr"+o,I=P.async;if(I&&!e.async)throw Error("async keyword in sync schema");if(y||E||(n+=w+" = null;"),n+="var "+h+" = errors;var "+v+";",m&&P.u&&(F+="}",n+=" if ("+i+" === undefined) { "+v+" = true; } else { ",$&&(F+="}",n+=" "+v+" = "+_+".validateSchema("+i+"); if ("+v+") { ")),y)n+=P.statements?" "+g.validate+" ":" "+v+" = "+g.validate+"; ";else if(E){var S=e.util.copy(e);F="";S.level++;var R="valid"+S.level;S.schema=g.validate,S.schemaPath="";var j=e.compositeRule;e.compositeRule=S.compositeRule=!0;var T=e.validate(S).replace(/validate\.schema/g,b);e.compositeRule=S.compositeRule=j,n+=" "+T}else{(k=k||[]).push(n),n="",n+="  "+b+".call( ",n+=e.opts.passContext?"this":"self",n+=p||!1===P.schema?" , "+c+" ":" , "+i+" , "+c+" , validate.schema"+e.schemaPath+" ",n+=" , (dataPath || '')",'""'!=e.errorPath&&(n+=" + "+e.errorPath);var D=s?"data"+(s-1||""):"parentData",x=s?e.dataPathArr[s]:"parentDataProperty",N=n+=" , "+D+" , "+x+" , rootData )  ";n=k.pop(),!1===P.errors?(n+=" "+v+" = ",I&&(n+="await "),n+=N+"; "):n+=I?" var "+(w="customErrors"+o)+" = null; try { "+v+" = await "+N+"; } catch (e) { "+v+" = false; if (e instanceof ValidationError) "+w+" = e.errors; else throw e; } ":" "+w+" = null; "+v+" = "+N+"; "}if(P.modifying&&(n+=" if ("+D+") "+c+" = "+D+"["+x+"];"),n+=""+F,P.valid)d&&(n+=" if (true) { ");else{var k;n+=" if ( ",void 0===P.valid?(n+=" !",n+=E?""+R:""+v):n+=" "+!P.valid+" ",t=this.keyword,(k=k||[]).push(n+=") { "),(k=k||[]).push(n=""),n="",!1!==e.createErrors?(n+=" { keyword: '"+(t||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { keyword: '"+this.keyword+"' } ",!1!==e.opts.messages&&(n+=" , message: 'should pass \""+this.keyword+"\" keyword validation' "),e.opts.verbose&&(n+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ";var C=n;n=k.pop();var z=n+=!e.compositeRule&&d?e.async?" throw new ValidationError(["+C+"]); ":" validate.errors = ["+C+"]; return false; ":" var err = "+C+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";n=k.pop(),y?P.errors?"full"!=P.errors&&(n+="  for (var "+O+"="+h+"; "+O+"<errors; "+O+"++) { var "+A+" = vErrors["+O+"]; if ("+A+".dataPath === undefined) "+A+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+A+".schemaPath === undefined) { "+A+'.schemaPath = "'+u+'"; } ',e.opts.verbose&&(n+=" "+A+".schema = "+i+"; "+A+".data = "+c+"; "),n+=" } "):!1===P.errors?n+=" "+z+" ":(n+=" if ("+h+" == errors) { "+z+" } else {  for (var "+O+"="+h+"; "+O+"<errors; "+O+"++) { var "+A+" = vErrors["+O+"]; if ("+A+".dataPath === undefined) "+A+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+A+".schemaPath === undefined) { "+A+'.schemaPath = "'+u+'"; } ',e.opts.verbose&&(n+=" "+A+".schema = "+i+"; "+A+".data = "+c+"; "),n+=" } } "):E?(n+="   var err =   ",!1!==e.createErrors?(n+=" { keyword: '"+(t||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { keyword: '"+this.keyword+"' } ",!1!==e.opts.messages&&(n+=" , message: 'should pass \""+this.keyword+"\" keyword validation' "),e.opts.verbose&&(n+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&d&&(n+=e.async?" throw new ValidationError(vErrors); ":" validate.errors = vErrors; return false; ")):!1===P.errors?n+=" "+z+" ":(n+=" if (Array.isArray("+w+")) { if (vErrors === null) vErrors = "+w+"; else vErrors = vErrors.concat("+w+"); errors = vErrors.length;  for (var "+O+"="+h+"; "+O+"<errors; "+O+"++) { var "+A+" = vErrors["+O+"]; if ("+A+".dataPath === undefined) "+A+".dataPath = (dataPath || '') + "+e.errorPath+";  "+A+'.schemaPath = "'+u+'";  ',e.opts.verbose&&(n+=" "+A+".schema = "+i+"; "+A+".data = "+c+"; "),n+=" } } else { "+z+" } "),n+=" } ",d&&(n+=" else { ")}return n},$schema="http://json-schema.org/draft-07/schema#",$id="http://json-schema.org/draft-07/schema#",title="Core schema meta-schema",definitions={schemaArray:{type:"array",minItems:1,items:{o:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{o:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type=["object","boolean"],properties$1={h:{type:"string",format:"uri-reference"},v:{type:"string",format:"uri"},o:{type:"string",format:"uri-reference"},l:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{o:"#/definitions/nonNegativeInteger"},minLength:{o:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{o:"#"},items:{anyOf:[{o:"#"},{o:"#/definitions/schemaArray"}],default:!0},maxItems:{o:"#/definitions/nonNegativeInteger"},minItems:{o:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{o:"#"},maxProperties:{o:"#/definitions/nonNegativeInteger"},minProperties:{o:"#/definitions/nonNegativeIntegerDefault0"},required:{o:"#/definitions/stringArray"},additionalProperties:{o:"#"},definitions:{type:"object",additionalProperties:{o:"#"},default:{}},properties:{type:"object",additionalProperties:{o:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{o:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{o:"#"},{o:"#/definitions/stringArray"}]}},propertyNames:{o:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{o:"#/definitions/simpleTypes"},{type:"array",items:{o:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{o:"#"},then:{o:"#"},else:{o:"#"},allOf:{o:"#/definitions/schemaArray"},anyOf:{o:"#/definitions/schemaArray"},oneOf:{o:"#/definitions/schemaArray"},not:{o:"#"}},jsonSchemaDraft07={v:$schema,h:$id,title,definitions,type,properties:properties$1,default:!0},jsonSchemaDraft07$1=Object.freeze({__proto__:null,v:$schema,h:$id,title,definitions,type,properties:properties$1,default:jsonSchemaDraft07}),require$$2=getCjsExportFromNamespace(jsonSchemaDraft07$1),definition_schema={h:"https://github.com/epoberezkin/ajv/blob/master/lib/definition_schema.js",definitions:{simpleTypes:require$$2.definitions.simpleTypes},type:"object",dependencies:{schema:["validate"],u:["validate"],statements:["inline"],valid:{not:{required:["macro"]}}},properties:{type:require$$2.properties.type,schema:{type:"boolean"},statements:{type:"boolean"},dependencies:{type:"array",items:{type:"string"}},metaSchema:{type:"object"},modifying:{type:"boolean"},valid:{type:"boolean"},u:{type:"boolean"},async:{type:"boolean"},errors:{anyOf:[{type:"boolean"},{const:"full"}]}}},IDENTIFIER$1=/^[a-z_$][a-z0-9_$-]*$/i,keyword={add:addKeyword,get:getKeyword,remove:removeKeyword,validate:validateKeyword};function addKeyword(e,r){var a=this.RULES;if(a.keywords[e])throw Error("Keyword "+e+" is already defined");if(!IDENTIFIER$1.test(e))throw Error("Keyword "+e+" is not a valid identifier");if(r){this.validateKeyword(r,!0);var t=r.type;if(Array.isArray(t))for(var i=0;i<t.length;i++)o(e,t[i],r);else o(e,t,r);var n=r.metaSchema;n&&(r.u&&this._opts.u&&(n={anyOf:[n,{o:"https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/data.json#"}]}),r.validateSchema=this.compile(n,!0))}function o(e,r,t){for(var i,n=0;n<a.length;n++){var o=a[n];if(o.type==r){i=o;break}}i||a.push(i={type:r,rules:[]});var s={keyword:e,definition:t,custom:!0,code:custom,implements:t.implements};i.rules.push(s),a.custom[e]=s}return a.keywords[e]=a.all[e]=!0,this}function getKeyword(e){var r=this.RULES.custom[e];return r?r.definition:this.RULES.keywords[e]||!1}function removeKeyword(e){var r=this.RULES;delete r.keywords[e],delete r.all[e],delete r.custom[e];for(var a=0;a<r.length;a++)for(var t=r[a].rules,i=0;i<t.length;i++)if(t[i].keyword==e){t.splice(i,1);break}return this}function validateKeyword(e,r){validateKeyword.errors=null;var a=this._validateKeyword=this._validateKeyword||this.compile(definition_schema,!0);if(a(e))return!0;if(validateKeyword.errors=a.errors,r)throw Error("custom keyword definition is invalid: "+this.errorsText(a.errors));return!1}var $schema$1="http://json-schema.org/draft-07/schema#",$id$1="https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/data.json#",description="Meta-schema for $data reference (JSON Schema extension proposal)",type$1="object",required$1=["$data"],properties$2={u:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties=!1,data$1={v:$schema$1,h:$id$1,description,type:type$1,required:required$1,properties:properties$2,additionalProperties},data$2=Object.freeze({__proto__:null,v:$schema$1,h:$id$1,description,type:type$1,required:required$1,properties:properties$2,additionalProperties,default:data$1}),require$$1=getCjsExportFromNamespace(data$2),ajv=Ajv;Ajv.prototype.validate=validate$1,Ajv.prototype.compile=compile$1,Ajv.prototype.addSchema=addSchema,Ajv.prototype.addMetaSchema=addMetaSchema,Ajv.prototype.validateSchema=validateSchema,Ajv.prototype.getSchema=getSchema,Ajv.prototype.removeSchema=removeSchema,Ajv.prototype.addFormat=addFormat,Ajv.prototype.errorsText=errorsText,Ajv.prototype._addSchema=_addSchema,Ajv.prototype._compile=_compile,Ajv.prototype.compileAsync=async,Ajv.prototype.addKeyword=keyword.add,Ajv.prototype.getKeyword=keyword.get,Ajv.prototype.removeKeyword=keyword.remove,Ajv.prototype.validateKeyword=keyword.validate,Ajv.ValidationError=error_classes.Validation,Ajv.MissingRefError=error_classes.MissingRef,Ajv.m=data;var META_SCHEMA_ID="http://json-schema.org/draft-07/schema",META_IGNORE_OPTIONS=["removeAdditional","useDefaults","coerceTypes","strictDefaults"],META_SUPPORT_DATA=["/properties"];function Ajv(e){if(!(this instanceof Ajv))return new Ajv(e);e=this._opts=util.copy(e)||{},setLogger(this),this._schemas={},this._refs={},this._fragments={},this._formats=formats_1(e.format),this._cache=e.cache||new cache,this._loadingSchemas={},this._compilations=[],this.RULES=rules(),this._getId=chooseGetId(e),e.loopRequired=e.loopRequired||Infinity,"property"==e.errorDataPath&&(e._errorDataPathProperty=!0),void 0===e.serialize&&(e.serialize=fastJsonStableStringify),this._metaOpts=getMetaSchemaOptions(this),e.formats&&addInitialFormats(this),e.keywords&&addInitialKeywords(this),addDefaultMetaSchema(this),"object"==typeof e.meta&&this.addMetaSchema(e.meta),e.nullable&&this.addKeyword("nullable",{metaSchema:{type:"boolean"}}),addInitialSchemas(this)}function validate$1(e,r){var a;if("string"==typeof e){if(!(a=this.getSchema(e)))throw Error('no schema with key or ref "'+e+'"')}else{var t=this._addSchema(e);a=t.validate||this._compile(t)}var i=a(r);return!0!==a.s&&(this.errors=a.errors),i}function compile$1(e,r){var a=this._addSchema(e,void 0,r);return a.validate||this._compile(a)}function addSchema(e,r,a,t){if(Array.isArray(e)){for(var i=0;i<e.length;i++)this.addSchema(e[i],void 0,a,t);return this}var n=this._getId(e);if(void 0!==n&&"string"!=typeof n)throw Error("schema id must be string");return checkUnique(this,r=resolve_1.normalizeId(r||n)),this._schemas[r]=this._addSchema(e,a,t,!0),this}function addMetaSchema(e,r,a){return this.addSchema(e,r,a,!0),this}function validateSchema(e,r){var a=e.v;if(void 0!==a&&"string"!=typeof a)throw Error("$schema must be a string");if(!(a=a||this._opts.defaultMeta||defaultMeta(this)))return this.logger.warn("meta-schema not available"),this.errors=null,!0;var t=this.validate(a,e);if(!t&&r){var i="schema is invalid: "+this.errorsText();if("log"!=this._opts.validateSchema)throw Error(i);this.logger.error(i)}return t}function defaultMeta(e){var r=e._opts.meta;return e._opts.defaultMeta="object"==typeof r?e._getId(r)||r:e.getSchema(META_SCHEMA_ID)?META_SCHEMA_ID:void 0,e._opts.defaultMeta}function getSchema(e){var r=_getSchemaObj(this,e);switch(typeof r){case"object":return r.validate||this._compile(r);case"string":return this.getSchema(r);case"undefined":return _getSchemaFragment(this,e)}}function _getSchemaFragment(e,r){var a=resolve_1.schema.call(e,{schema:{}},r);if(a){var t=a.schema,i=a.root,n=a.baseId,o=compile_1.call(e,t,i,void 0,n);return e._fragments[r]=new schema_obj({ref:r,fragment:!0,schema:t,root:i,baseId:n,validate:o}),o}}function _getSchemaObj(e,r){return r=resolve_1.normalizeId(r),e._schemas[r]||e._refs[r]||e._fragments[r]}function removeSchema(e){if(e instanceof RegExp)return _removeAllSchemas(this,this._schemas,e),_removeAllSchemas(this,this._refs,e),this;switch(typeof e){case"undefined":return _removeAllSchemas(this,this._schemas),_removeAllSchemas(this,this._refs),this._cache.clear(),this;case"string":var r=_getSchemaObj(this,e);return r&&this._cache.del(r.cacheKey),delete this._schemas[e],delete this._refs[e],this;case"object":var a=this._opts.serialize,t=a?a(e):e;this._cache.del(t);var i=this._getId(e);i&&(i=resolve_1.normalizeId(i),delete this._schemas[i],delete this._refs[i])}return this}function _removeAllSchemas(e,r,a){for(var t in r){var i=r[t];i.meta||a&&!a.test(t)||(e._cache.del(i.cacheKey),delete r[t])}}function _addSchema(e,r,a,t){if("object"!=typeof e&&"boolean"!=typeof e)throw Error("schema should be object or boolean");var i=this._opts.serialize,n=i?i(e):e,o=this._cache.get(n);if(o)return o;t=t||!1!==this._opts.addUsedSchema;var s=resolve_1.normalizeId(this._getId(e));s&&t&&checkUnique(this,s);var f,l=!1!==this._opts.validateSchema&&!r;l&&!(f=s&&s==resolve_1.normalizeId(e.v))&&this.validateSchema(e,!0);var u=resolve_1.ids.call(this,e),d=new schema_obj({id:s,schema:e,localRefs:u,cacheKey:n,meta:a});return"#"!=s[0]&&t&&(this._refs[s]=d),this._cache.put(n,d),l&&f&&this.validateSchema(e,!0),d}function _compile(e,r){if(e.compiling)return e.validate=i,i.schema=e.schema,i.errors=null,i.root=r||i,!0===e.schema.s&&(i.s=!0),i;var a,t;e.compiling=!0,e.meta&&(a=this._opts,this._opts=this._metaOpts);try{t=compile_1.call(this,e.schema,r,e.localRefs)}catch(r){throw delete e.validate,r}finally{e.compiling=!1,e.meta&&(this._opts=a)}return e.validate=t,e.refs=t.refs,e.refVal=t.refVal,e.root=t.root,t;function i(){var r=e.validate,a=r.apply(this,arguments);return i.errors=r.errors,a}}function chooseGetId(e){switch(e.schemaId){case"auto":return _get$IdOrId;case"id":return _getId;default:return _get$Id}}function _getId(e){return e.h&&this.logger.warn("schema $id ignored",e.h),e.id}function _get$Id(e){return e.id&&this.logger.warn("schema id ignored",e.id),e.h}function _get$IdOrId(e){if(e.h&&e.id&&e.h!=e.id)throw Error("schema $id is different from id");return e.h||e.id}function errorsText(e,r){if(!(e=e||this.errors))return"No errors";for(var a=void 0===(r=r||{}).separator?", ":r.separator,t=void 0===r.dataVar?"data":r.dataVar,i="",n=0;n<e.length;n++){var o=e[n];o&&(i+=t+o.dataPath+" "+o.message+a)}return i.slice(0,-a.length)}function addFormat(e,r){return"string"==typeof r&&(r=RegExp(r)),this._formats[e]=r,this}function addDefaultMetaSchema(e){var r;if(e._opts.u&&e.addMetaSchema(r=require$$1,r.h,!0),!1!==e._opts.meta){var a=require$$2;e._opts.u&&(a=data(a,META_SUPPORT_DATA)),e.addMetaSchema(a,META_SCHEMA_ID,!0),e._refs["http://json-schema.org/schema"]=META_SCHEMA_ID}}function addInitialSchemas(e){var r=e._opts.schemas;if(r)if(Array.isArray(r))e.addSchema(r);else for(var a in r)e.addSchema(r[a],a)}function addInitialFormats(e){for(var r in e._opts.formats){e.addFormat(r,e._opts.formats[r])}}function addInitialKeywords(e){for(var r in e._opts.keywords){e.addKeyword(r,e._opts.keywords[r])}}function checkUnique(e,r){if(e._schemas[r]||e._refs[r])throw Error('schema with key or id "'+r+'" already exists')}function getMetaSchemaOptions(e){for(var r=util.copy(e._opts),a=0;a<META_IGNORE_OPTIONS.length;a++)delete r[META_IGNORE_OPTIONS[a]];return r}function setLogger(e){var r=e._opts.logger;if(!1===r)e.logger={log:noop,warn:noop,error:noop};else{if(void 0===r&&(r=console),!("object"==typeof r&&r.log&&r.warn&&r.error))throw Error("logger must implement log, warn and error methods");e.logger=r}}function noop(){}const validate$2=e=>{const r=new ajv({allErrors:!0});if(r.validate(schema,e),null!=r.errors){const e=Infinity;let a=[];return r.errors.forEach(r=>{const t=r.schemaPath.split("/").length;t===e?a.push(formatError(r)):t<e&&(a=[formatError(r)])}),a}return[]},formatError=e=>`Ainsley${e.dataPath}${void 0===e.message?"":" "+e.message}`,schema={v:"http://json-schema.org/draft-07/schema#",definitions:{Primitive:{anyOf:[{type:"string"},{type:"number"}]}},properties:{children:{items:{anyOf:[{items:[{type:"string"},{items:{items:[{type:"string"},{o:"#/definitions/Primitive"}],minItems:2,maxItems:2,type:"array"},type:"array"}],minItems:2,maxItems:2,type:"array"},{items:[{type:"string"},{anyOf:[{type:"object",additionalProperties:{o:"#/definitions/Primitive"}},{type:"array",items:{anyOf:[{o:"#/definitions/Primitive"},{items:[{o:"#/definitions/Primitive"},{o:"#/definitions/Primitive"}],minItems:2,maxItems:2,type:"array"}]}}]}],minItems:2,maxItems:2,type:"array"},{type:"string"},{o:"#"}]},type:"array"},variables:{type:"object",additionalProperties:{type:"object",additionalProperties:{o:"#/definitions/Primitive"}}},variations:{items:{items:{items:[{type:"string"},{type:"string"}],minItems:2,maxItems:2,type:"array"},type:"array"},type:"array"}},type:"object"},flatten=async(e,r=defaultGetConfig)=>{const a=validate$2(e);if(a.length>0)throw Error("Invalid input Ainsley:\n"+a.join("\n"));const t=copy$1(e);return Array.isArray(t.children)&&await Promise.all(t.children.map(async(e,a)=>{if("string"==typeof e&&e.startsWith("$")){const i=await getFlatConfig(e.slice(1),r);t.children[a]=i}return e})),t},defaultGetConfig=async e=>{var r;try{return require("ainsley-config-"+e).config}catch(a){try{const a=new URL(e),t=await fetch(a.href);return(null!==(r=t.headers.get("Content-Type"))&&void 0!==r?r:"").endsWith("/json")?await t.json():await t.text()}catch(r){return await Promise.resolve(`/* $${e} */`)}}},getFlatConfig=async(e,r)=>{try{const a=await r(e);return isObject(a)?await flatten(a,r):a}catch(r){return`/* $${e} */`}};var _a;let csso=null===(_a=globalThis)||void 0===_a?void 0:_a.csso;void 0===csso&&Promise.resolve().then((function(){return _interopNamespace(require("csso"))})).then(({default:e})=>{csso=e}).catch(()=>{});const minify=e=>{var r,a;const t=validate$2(e);if(t.length>0)throw Error("Invalid input Ainsley:\n"+t.join("\n"));const i=toAST(copy$1(e),new Set);for(let e=i.length-1;e>=0;e--){const t=i[e];if(void 0===t.ainsley.children||0===t.ainsley.children.length){if(void 0!==t.parent){const e=null!==(r=t.parent.ainsley.children)&&void 0!==r?r:[];e.splice(e.findIndex(e=>e===t.ainsley),1)}continue}for(let e=0;e<t.ainsley.children.length;e++){const r=t.ainsley.children[e];if("string"==typeof r)if(0===r.length)t.ainsley.children.splice(e--,1);else if(e>0){const a=t.ainsley.children[e-1];"string"==typeof a&&t.ainsley.children.splice(--e,2,`${a}${r}`)}}const n=null!==(a=t.ainsley.variables)&&void 0!==a?a:{};if(Object.keys(n).forEach(e=>{var r,a,i;const[o,s]=parseVariable$1(e);if(t.usageCounts.has(s)){if(void 0!==t.parent){if(1===o&&t.parent.definedVariables.has(s))return void delete n[e];if((null!==(r=t.parent.usageCounts.get(s))&&void 0!==r?r:0)<2){"variables"in t.parent.ainsley||(t.parent.ainsley.variables={});const r=t.parent.ainsley.variables,f=null!==(a=Object.keys(r).find(e=>e.endsWith(s)))&&void 0!==a?a:buildVariable(o,""),[l]=parseVariable$1(f),u=null!==(i=r[f])&&void 0!==i?i:{},d=n[e];void 0!==r[f]&&delete r[f],delete n[e],r[buildVariable(2===o?l:0,s)]={...2===o?u:{},...d}}}}else delete n[e]}),0===Object.keys(n).length&&delete t.ainsley.variables,Array.isArray(t.ainsley.variations)&&(t.ainsley.variations=t.ainsley.variations.filter(e=>0!==e.length)),Array.isArray(t.ainsley.variations)&&0===t.ainsley.variations.length&&delete t.ainsley.variations,!("variations"in t.ainsley)&&!("variables"in t.ainsley)&&void 0!==t.parent){const e=t.parent.ainsley.children,r=e.findIndex(e=>e===t.ainsley);-1!==r&&e.splice(r,1,...t.ainsley.children)}}return i[0].ainsley},MODIFIERS="?+",parseVariable$1=e=>{const r="?+".indexOf(e[0])+1;return[r,r>0?e.slice(1):e]},buildVariable=(e,r)=>`${["","?","+"][e]}${r}`,minifyRaw=e=>{try{return csso.minify(e).css}catch(r){return csso&&csso.minify?console.error(r):console.warn("`csso` - an optional dependency - is not installed; inline CSS will not be minified"),e}},iteratorRegex=/\{[a-z]+\}/gi,searchForUsages=(e,r=new Set)=>(e.forEach(e=>{if(Array.isArray(e))searchForUsages(e,r);else if("string"==typeof e){const a=e.match(iteratorRegex);for(let e=0;e<(null!=a?a:[]).length;e++)r.add(a[e].slice(1,-1))}}),r),toAST=(e,r,a)=>{var t,i;const n=null!==(t=e.children)&&void 0!==t?t:[],o=new Map,s={ainsley:e,parent:a,usageCounts:o,definedVariables:r},f=[s];for(let e=0;e<n.length;e++){const a=n[e];if(isObject(a)){const e=null!==(i=a.variables)&&void 0!==i?i:{},t=toAST(a,new Set([...r,...Object.keys(e).map(e=>parseVariable$1(e)[1])]),s);new Set(t.map(e=>[...e.usageCounts.keys()]).reduce((e,r)=>[...e,...r],[])).forEach(e=>{var r;o.set(e,(null!==(r=o.get(e))&&void 0!==r?r:0)+1)}),f.push(...t)}else if(Array.isArray(a)){searchForUsages(a).forEach(e=>{var r;o.set(e,(null!==(r=o.get(e))&&void 0!==r?r:0)+1)})}else n.splice(e,1,minifyRaw(a))}return f};exports.DEFAULT_OPTIONS=DEFAULT_OPTIONS,exports.ITERATOR_REGEX=ITERATOR_REGEX,exports.combinations=combinations,exports.defaultGetConfig=defaultGetConfig,exports.embed=embed,exports.flatten=flatten,exports.generate=generate,exports.getFlatConfig=getFlatConfig,exports.isObject=isObject,exports.minify=minify,exports.schema=schema,exports.validate=validate$2;
//# sourceMappingURL=ainsley.cjs.production.js.map
